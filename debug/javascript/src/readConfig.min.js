function readConfig(){require(["dojo/dom","dojo/io-query","esri/core/promiseUtils","esri/core/reactiveUtils","esri/layers/GroupLayer","esri/layers/SubtypeGroupLayer","esri/layers/MapImageLayer","esri/layers/FeatureLayer","esri/layers/WMSLayer","esri/rest/geometryService","esri/geometry/SpatialReference","esri/Graphic","esri/Map","esri/views/MapView","esri/widgets/Print","esri/geometry/Extent","esri/widgets/Home","esri/widgets/Expand","esri/widgets/LayerList","esri/widgets/Legend","esri/widgets/Locate","esri/widgets/Search","esri/widgets/ScaleBar","esri/widgets/Slider","esri/rest/support/ProjectParameters","esri/symbols/SimpleFillSymbol","dijit/form/CheckBox","dijit/layout/ContentPane","dijit/TitlePane","dijit/layout/TabContainer","esri/symbols/SimpleLineSymbol","esri/arcade","esri/layers/support/arcadeUtils","dojo/sniff"],function(e,t,r,a,i,l,n,s,o,p,u,g,d,c,y,m,b,f,h,v,w,E,x,A,O,T,B,I,S,L,q,N,k,M){function C(){function e(e){for(var t,r=e.getAttribute("label"),a=0;a<view.allLayerViews.items.length;a++)if(r===view.allLayerViews.items[a].layer.id&&view.allLayerViews.items[a].layer.loaded)return;if(K[r]++,queryObj.layer&&""!=queryObj.layer)if(e.getAttribute("url").toLowerCase().indexOf("mapserver")>-1)t=layerObj[r]?new n({url:e.getAttribute("url"),opacity:layerObj[r].opacity,title:r,id:r,visible:layerObj[r].visible,sublayers:layerObj[r].visLayers}):new n({url:e.getAttribute("url"),opacity:Number(e.getAttribute("alpha")),title:r,id:r,visible:!1});else{if(!(e.getAttribute("url").toLowerCase().indexOf("featureserver")>-1))return void alert("Unknown operational layer type. It must be of type MapServer or FeatureServer. Or edit readConfig.js line 600 to add new type.");t=layerObj[r]?new s({url:e.getAttribute("url"),opacity:Number(e.getAttribute("alpha")),title:r,visible:layerObj[r].visible}):new s({url:e.getAttribute("url"),opacity:Number(e.getAttribute("alpha")),title:r,visible:!1})}else if(e.getAttribute("url").toLowerCase().indexOf("mapserver")>-1)t=new n({url:e.getAttribute("url"),opacity:Number(e.getAttribute("alpha")),title:r,id:r,visible:"true"==e.getAttribute("visible")});else{if(!(e.getAttribute("url").toLowerCase().indexOf("featureserver")>-1))return void alert("Unknown operational layer type. It must be of type MapServer or FeatureServer. Or edit readConfig.js line 600 to add new type.");if(t=new s({url:e.getAttribute("url"),opacity:Number(e.getAttribute("alpha")),title:r,id:r,visible:"true"==e.getAttribute("visible"),legendEnabled:!0}),e.getAttribute("popup_fields")&&e.getAttribute("popup_labels")){const r=u(e.getAttribute("label"),e.getAttribute("popup_fields").split(","),e.getAttribute("popup_labels").split(","));null!=r&&(t.popupTemplate=r)}}map.add(t)}function t(t){if("group"!==t.layer.parent.type){for(var r=0;r<view.allLayerViews.items.length;r++)if(t.layer.id===view.allLayerViews.items[r].layer.id&&view.allLayerViews.items[r].loaded)return;var a;for(console.log(t.layer.id+" failed to load!!!!!!!"),console.log("tries="+K[t.layer.title]),r=0;r<V.getElementsByTagName("operationallayers")[0].getElementsByTagName("layer").length;r++)if(V.getElementsByTagName("operationallayers")[0].getElementsByTagName("layer")[r].getAttribute("label")===t.layer.id){a=V.getElementsByTagName("operationallayers")[0].getElementsByTagName("layer")[r];break}K[t.layer.title]<4?setTimeout(function(){e(a)},2e3):4==K[t.layer.title]?(t.layer.id.indexOf("Motor Vehicle")>-1||t.layer.id.indexOf("Wildfire")>-1||t.layer.id.indexOf("BLM")>-1?alert("The external map service that provides "+t.layer.id+" is experiencing problems.  This issue is out of CPW control. We will continue to try to load it. We apologize for any inconvenience.","External (Non-CPW) Map Service Error"):alert(t.layer.id+" service is busy or not responding. We will continue to try to load it.","Data Error"),setTimeout(function(){e(a)},3e4)):(console.log("Retrying to load: "+t.layer.id),a.getAttribute("url").indexOf("oooo")>-1&&a.setAttribute("url",a.getAttribute("url").substring(0,a.getAttribute("url").length-4)),console.log("url="+a.getAttribute("url")),setTimeout(function(){e(a)},3e4))}else o(t)}async function r(e){if(K[e.layer.id]&&K[e.layer.id]>1){var t;if(0==d.length)for(var r=0;r<V.getElementsByTagName("operationallayers")[0].getElementsByTagName("layer").length;r++)null===V.getElementsByTagName("operationallayers")[0].getElementsByTagName("layer")[r].getAttribute("parentGroup")&&(V.getElementsByTagName("operationallayers")[0].getElementsByTagName("layer")[r].getAttribute("label")?d.push({title:V.getElementsByTagName("operationallayers")[0].getElementsByTagName("layer")[r].getAttribute("label"),type:"layer",parentId:null}):V.getElementsByTagName("operationallayers")[0].getElementsByTagName("layer")[r].getAttribute("group")&&d.push({title:V.getElementsByTagName("operationallayers")[0].getElementsByTagName("layer")[r].getAttribute("group"),type:"group",parentId:null}));var a=!1;for(r=0;r<d.length;r++)if(d[r].title===e.layer.id){a=!0;break}if(a)if(r+1==d.length)map.reorder(e.layer,r+1);else{var i=!1;for(t=r+1;t<d.length&&!i;t++)for(var l=0;l<view.layerViews.items.length;l++)if(d[t].title===view.layerViews.items[l].layer.title){map.reorder(e.layer,l+1),i=!0;break}i||map.reorder(e.layer,view.layerViews.items.length)}alert("Was able to sucessfully load: "+e.layer.id),e.layer.refresh}}function a(e){var t=[];if("string"==typeof e)for(var r=e.split(","),a=0;a<r.length;a++)if(r[a].indexOf("-")>-1){let e=r[a].split("-");for(var i=parseInt(e[0]);i<parseInt(e[1])+1;i++)t.push(parseInt(i))}else t.push(parseInt(r[a]));else t=e.split(",");return t=t.reverse(),t}function l(e,t,r,l,n,s,o,u,g,d,c){var y,m="independent";if(l&&(m="exclusive"),t="true"===t.toLowerCase(),y=new i(s?{portalItem:{id:s},title:e,id:e,opacity:Number(r),visible:t}:r?{title:e,id:e,visible:t,opacity:parseFloat(r),visibilityMode:m}:{title:e,id:e,visible:t,visibilityMode:m}),!n)return y;"/"!=n.substr(n.length-1)&&(n+="/");var b=a(o);if(u=u.reverse(),u.length!=b.length)return alert("Error in "+app+"/config.xml operationallayers. In layer group "+e+", list of layerIds and layerVis must have the same number of elements."),y;if(null!=g&&(g=g.reverse(),u.length!=g.length))return alert("Error in "+app+"/config.xml operationallayers. In layer group "+e+", list of layerIds, layerVis, and layerNames must have the same number of elements."),y;for(var f=0;f<b.length;f++)null==u[f]&&alert("Missing layerVis item ("+f+") for "+e+" in config.xml. Should be true or false.","Data Error"),t="true"===u[f].toLowerCase(),K[y.title+b[f]]=0,p(y,n,t,b[f],null!=g?g[f]:null,d,c);return y}function o(e){var t=e.layer;K[t.parent.title+t.id]++,setTimeout(function(){for(var e=[],r=[],a=0;a<V.getElementsByTagName("operationallayers")[0].getElementsByTagName("layer").length;a++)if(V.getElementsByTagName("operationallayers")[0].getElementsByTagName("layer")[a].getAttribute("group")===t.parent.title){V.getElementsByTagName("operationallayers")[0].getElementsByTagName("layer")[a].getAttribute("popup_fields")&&(e=V.getElementsByTagName("operationallayers")[0].getElementsByTagName("layer")[a].getAttribute("popup_fields").split(","),r=V.getElementsByTagName("operationallayers")[0].getElementsByTagName("layer")[a].getAttribute("popup_labels").split(","));break}console.log("trying to load layer again: "+t.parent.title+" "+t.id),p(t.parent,t.url,t.visible,t.id,t.title,e,r),t.parent.remove(t)},3e4)}function p(e,t,r,i,l,n,o){var p,g;p="/"===t[t.length-1]?t+i:t+"/"+i;var d=t.indexOf("/services/")+10,y=t.substr(d);d=y.indexOf("/");var m=y.substr(0,d);if(null!==l&&l!==m){if(g=new s({url:p,visible:r,title:l,legendEnabled:!0}),n&&o){const e=u(l,n,o);null!=e&&(g.popupTemplate=e)}}else g=new s({url:p,visible:r,legendEnabled:!0}),g.on("layerview-create",function(e){var t=e.layerView.layer;-1==m.indexOf(" - ")&&(m+=" - ");var r=t.title.substr(m.length);if(t.title=r,n&&o){const e=u(r,n,o);null!=e&&(g.popupTemplate=e)}console.log("sub group layer loaded: "+t.parent.title+" "+r+" url="+p)});e.title&&K[e.title+i]>0&&g.on("layerview-create",function(e){var t=e.layerView.layer;if(0==c.length)for(var r=0;r<V.getElementsByTagName("operationallayers")[0].getElementsByTagName("layer").length;r++)if(V.getElementsByTagName("operationallayers")[0].getElementsByTagName("layer")[r].getAttribute("layerIds")){var i=a(V.getElementsByTagName("operationallayers")[0].getElementsByTagName("layer")[r].getAttribute("layerIds"));for(j=0;j<i.length;j++)c.push({title:i[j],type:"layer",parentId:V.getElementsByTagName("operationallayers")[0].getElementsByTagName("layer")[r].getAttribute("group"),grandparentId:V.getElementsByTagName("operationallayers")[0].getElementsByTagName("layer")[r].getAttribute("parentGroup")})}var l=[],n=0;for(r=0;r<c.length;r++)c[r].parentId===t.parent.title&&(l.push(c[r].title.toString()),c[r].title.toString()===t.id&&(n=l.length-1));if(n++,n==l.length)t.parent.reorder(t,t.parent.layers.items.length);else{var s=!1;do{for(r=0;r<t.parent.layers.items.length;r++)if(l[n]===t.parent.layers.items[r].id){t.parent.reorder(t,r),s=!0;break}n++}while(!s&&n<l.length)}console.log("reorder group layer "+t.title)}),e.add(g)}function u(e,t,r){if(t.length>0){const n={title:e,content:[{type:"fields"}]};for(var a=[],i=0;i<t.length;i++){if(!t[i]||!r[i])return alert("Error in config.xml missing popup_fields or popup_labels for layer "+e),null;var l={fieldName:t[i],label:r[i]};a.push(l)}return n.content[0].fieldInfos=a,n}return null}var g;!0;var d=[],c=[];if(view.on("layerview-create-error",t),view.on("layerview-create",r),queryObj.layer&&""!=queryObj.layer){!1;var y=queryObj.layer.substring(queryObj.layer.indexOf("|")+1).split(",");for(layerObj={},g=0;g<y.length;g++){var m=y[g].split("|");if(""!=m[0])for(m[0]=m[0].replace(/~/g," "),3==m.length&&m.push(!0),-1==m[2]?layerObj[m[0]]={opacity:m[1],visLayers:[],visible:!0}:layerObj[m[0]]={opacity:m[1],visLayers:m[2].split("-"),visible:"1"==m[3]},j=0;j<layerObj[m[0]].visLayers.length;j++)layerObj[m[0]].visLayers[j]=0|layerObj[m[0]].visLayers[j]}}try{V.getElementsByTagName("hideGroupSublayers")[0]&&V.getElementsByTagName("hideGroupSublayers")[0].firstChild&&(hideGroupSublayers=V.getElementsByTagName("hideGroupSublayers")[0].firstChild.nodeValue.split(","))}catch(e){alert("Warning: Missing hideGroupSublayers tag in "+app+"/config.xml file. "+e.message,"Data Error")}try{V.getElementsByTagName("radiolayers")[0]&&V.getElementsByTagName("radiolayers")[0].firstChild&&(radioLayers=V.getElementsByTagName("radiolayers")[0].firstChild.nodeValue.split(","))}catch(e){alert("Warning: Missing radiolayers tag in "+app+"/config.xml file. "+e.message,"Data Error")}var b,f=V.getElementsByTagName("operationallayers")[0].getElementsByTagName("layer"),h=[],v=/([^a-zA-Z0-9 \-,\._\/:])/g,w=[],E=[];for(g=0;g<f.length;g++){var x=null,A=null,O=null,T=null,B=null,I=null;if(f[g].getAttribute("group")&&""!=f[g].getAttribute("group"))try{var S=1,L="false",q="false",N=!1;if(b=f[g].getAttribute("group").replace(v,""),f[g].getAttribute("parentGroup")&&(T=f[g].getAttribute("parentGroup").replace(v,""),null==h[T])){alert("Invalid parentGroup ("+T+") in layer group="+f[g].getAttribute("group")+" in "+app+"/config.xml file.","Data Error");continue}if(f[g].getAttribute("visible")&&(L=f[g].getAttribute("visible").replace(v,"")),f[g].getAttribute("open")&&(q=f[g].getAttribute("open").replace(v,""),"true"===q&&openTOCgroups.push(b)),f[g].getAttribute("alpha")&&(S=f[g].getAttribute("alpha").replace(v,"")),f[g].getAttribute("radio")&&(N="true"===f[g].getAttribute("radio").replace(v,"")),f[g].getAttribute("portal")&&(I=f[g].getAttribute("portal").replace(v,"")),f[g].getAttribute("url")){if(x=f[g].getAttribute("url").replace(v,""),!f[g].getAttribute("layerIds")){alert("Missing layerIds tag in layer group, "+b+", in "+app+"/config.xml file.","Data Error");continue}if(A=f[g].getAttribute("layerIds").replace(v,""),!f[g].getAttribute("layerVis")){alert("Missing layerVis tag in layer group, "+b+", in "+app+"/config.xml file.","Data Error");continue}O=f[g].getAttribute("layerVis").replace(v,"").split(","),f[g].getAttribute("layerName")&&(B=f[g].getAttribute("layerNames").replace(v,"")),f[g].getAttribute("popup_fields")&&(w=f[g].getAttribute("popup_fields").split(",")),f[g].getAttribute("popup_labels")&&(E=f[g].getAttribute("popup_labels").split(","))}h[b]={layer:l(b,L,S,N,x,I,A,O,B,w,E)},null!=T&&""!=T?h[T].layer.add(h[b].layer):map.add(h[b].layer)}catch(e){alert("Warning: misconfigured operational group layer, "+b+", in config.xml file. "+e.message,"Data Error")}else if(f[g].getAttribute("label")&&f[g].getAttribute("parentGroup")){w=[],E=[];var k="";if(!f[g].getAttribute("parentGroup")||""==f[g].getAttribute("parentGroup")){alert("Missing parentGroup attribute in layer group, "+b+", in "+app+"/config.xml file.","Data Error");continue}if(T=f[g].getAttribute("parentGroup").replace(v,""),!f[g].getAttribute("label")){alert("Missing label attribute in layer, "+g+", in operationallayers tag in "+app+"/config.xml file.","Data Error");continue}if(k=f[g].getAttribute("label").replace(v,""),!f[g].getAttribute("url")){alert("Missing url attribute in layer, "+k+", in group, "+f[g].getAttribute("parentGroup")+", in "+app+"/config.xml file.","Data Error");continue}if(x=f[g].getAttribute("url").replace(v,""),f[g].getAttribute("alpha"))var M=f[g].getAttribute("alpha").replace(v,"");if(!f[g].getAttribute("visible")){alert("Missing visible attribute in layer, "+b+", in "+app+"/config.xml file.","Data Error");continue}O=f[g].getAttribute("visible").replace(v,"").split(","),f[g].getAttribute("popup_fields")&&(w=f[g].getAttribute("popup_fields").split(",")),f[g].getAttribute("popup_labels")&&(E=f[g].getAttribute("popup_labels").split(","));var C=new s({visible:"true"===O,url:x,title:k,opacity:Number(M),layerId:k,id:k});if(w&&E){const e=u(k,w,E);null!=e&&(C.popupTemplate=e)}h[T]?h[T].layer.add(C):alert("Error in "+app+"/config.xml file. parentGroup name of "+T+" does not exist. Must have a layer with group="+T)}else f[g].getAttribute("label")&&(K[f[g].getAttribute("label")]=0,console.log("loading layer "+f[g].getAttribute("label")+" i="+g),e(f[g]))}_()}async function D(e){const t=e.item;if(await t.layer.when(),t.watch("visible",e=>{Z.operationalItems.forEach(e=>{e.children.forEach(e=>{t.parent&&t.parent.title===e.parent.title&&"exclusive"===t.parent.visibilityMode&&(e.layer.id!=t.layer.id?e.open=!1:e.open=!0)})})}),openTOCgroups.includes(t.title)&&(t.open=!0),0==t.children.length&&t.parent||null===t.parent){const e=new A({min:0,max:1,precision:2,values:[t.layer.opacity],visibleElements:{labels:!0,rangeLabels:!0}});t.panel={content:e,className:"esri-icon-sliders-horizontal",title:"Change layer opacity"},e.on("thumb-drag",e=>{const{value:r}=e;t.layer.opacity=r})}null===t.parent&&(t.actionsSections=[[{title:"Layer information",className:"esri-icon-description",id:"information"}]])}function _(){require(["dojo/dom","dijit/registry"],function(e,t){for(var r="",a=0;a<V.getElementsByTagName("widget").length;a++){var i="open"==V.getElementsByTagName("widget")[a].getAttribute("preload"),l=V.getElementsByTagName("widget")[a].getAttribute("label"),n=(V.getElementsByTagName("widget")[a].getAttribute("height"),V.getElementsByTagName("widget")[a].getAttribute("video")),s=V.getElementsByTagName("widget")[a].getAttribute("icon");if(null!=l)if(r+=l,"Map Layers & Legend"==l){var o=new S({title:"<img id='tocIcon' role='presentation' alt='map layers icon' src='assets/images/i_layers.png'/> Map Layers",open:i,content:document.getElementById("tocContent")},"tocPane");o.startup(),document.getElementById("tocHelpBtn").addEventListener("click",function(){show("tocHelpDialog")}),Z=new h({view:view,listItemCreatedFunction:D,container:document.getElementById("layersContent")}),Z.when(()=>{for(var e=document.getElementsByClassName("esri-layer-list__item--has-children"),t=0;t<e.length;t++){var r=e[t].children[0].children[1].children[1].innerHTML;if(hideGroupSublayers.includes(r))e[t].children[0].children[0].style.visibility="hidden",e[t].children[1].style.display="none";else if("Status"===r){for(var a=0;a<map.layers.length;a++)if("Motor Vehicle Use Map"===map.layers.items[a].title){for(var i=0;i<map.layers.items[a].sublayers.length;i++)if("Status"===map.layers.items[a].sublayers.items[i].title){map.layers.items[a].sublayers.items[i].visible=!1;break}break}e[t].children[0].children[1].children[0].children[0].className="esri-icon-non-visible"}}}),Z.on("trigger-action",e=>{const t=e.item.layer,r=e.action.id;"full-extent"===r?view.goTo(visibleLayer.fullExtent).catch(e=>{"AbortError"!=e.name&&console.error(e)}):"information"===r?window.open("/"+app+"/definitions.html"):"increase-opacity"===r?t.opacity<2&&(t.opacity+=.25):"decrease-opacity"===r&&t.opacity>0&&(t.opacity-=.25)}),null==n&&alert("Warning: Missing help video in "+app+"/config.xml file for widget Map Layers & Legend.","Data Error"),e.byId("tocHelp").href=n,s&&(document.getElementById("tocIcon").src=s),e.byId("tocPane").style.display="block",e.byId("tocPane").style.visibility="visible"}else if(l.indexOf("Resource Report")>0){var p=new S({title:"<img id='reportIcon' role='presentation' alt='resrouce report icon' src='assets/images/i_table.png'/> "+l,open:i,content:document.getElementById("reportContent")});p.startup(),document.getElementById("reportDiv").appendChild(p.domNode),document.getElementById("reportHelpBtn").addEventListener("click",function(){show("reportHelpDialog")}),null==n&&alert("Warning: Missing help video in "+app+"/config.xml file for widget "+l+".","Data Error"),e.byId("reportHelp").href=n,s&&(document.getElementById("reportIcon").src=s),e.byId("reportDiv").style.display="block",e.byId("reportDiv").style.visibility="visible"}else if("Feature Search"==l){var u=new S({title:"<img id='searchIcon' role='presentation' alt='feature search icon' src='assets/images/i_search.png'/> "+l,open:i,content:document.getElementById("searchContent")});u.startup(),document.getElementById("searchDiv").appendChild(u.domNode),document.getElementById("searchHelpBtn").addEventListener("click",function(){show("featureSearchHelpDialog")}),null==n&&alert("Warning: Missing help video in "+app+"/config.xml file for widget Feature Search.","Data Error"),e.byId("searchHelp").href=n,s&&(document.getElementById("searchIcon").src=s),i&&(openedFeatureSearch=!0),e.byId("searchDiv").style.display="block",e.byId("searchDiv").style.visibility="visible"}else{if("Address"==l)continue;if("Draw, Label, & Measure"==l){var g=new S({title:"<img id='drawIcon' role='presentation' alt='feature search icon' src='assets/images/i_measure.png'/> "+l,open:i,content:document.getElementById("drawContent")});g.startup(),document.getElementById("drawDiv").appendChild(g.domNode),document.getElementById("drawHelpBtn").addEventListener("click",function(){show("drawHelpDialog")}),null==n&&alert("Warning: Missing help video in "+app+"/config.xml file for widget Draw, Label, & Measure.","Data Error"),e.byId("drawHelp").href=n,s&&(document.getElementById("drawIcon").src=s),e.byId("drawDiv").style.display="block",e.byId("drawDiv").style.visibility="visible"}else if("Bookmark"==l){var d=new S({title:"<img id='bookmarkIcon' role='presentation' alt='bookmark icon' src='assets/images/i_bookmark.png'/> "+l,open:i,content:document.getElementById("bookmarkContent")});d.startup(),document.getElementById("bookmarkDiv").appendChild(d.domNode),document.getElementById("bookmarkHelpBtn").addEventListener("click",function(){show("bookmarkHelpDialog")}),null==n&&alert("Warning: Missing help video in "+app+"/config.xml file for widget Bookmark.","Data Error"),e.byId("bookmarkHelp").href=n,s&&(document.getElementById("bookmarkIcon").src=s),e.byId("bookmarkDiv").style.display="block",e.byId("bookmarkDiv").style.visibility="visible"}else if("Settings"==l){var c=!0;screen.width<768&&(c=!1);var y=new S({title:"<img id='settingsIcon' alt='settings icon' src='assets/images/i_resources.png'/> "+l,open:!1,content:document.getElementById("settingsContent")});y.startup(),document.getElementById("settingsDiv").appendChild(y.domNode),document.getElementById("settingsHelpBtn").addEventListener("click",function(){show("settingsHelpDialog")}),document.getElementById("toolsMenuChkBox").checked=c,null==n&&alert("Warning: Missing help video in "+app+"/config.xml file for widget Settings.","Data Error"),e.byId("settingsHelp").href=n,s&&(document.getElementById("settingsIcon").src=s),e.byId("settingsDiv").style.display="block",e.byId("settingsDiv").style.visibility="visible"}else"Identify"==l||("MapLink"==l?s&&(document.getElementById("linkIcon").src=s):alert("Error in "+app+"/config.xml widget. Label: "+l+" was not found.  \n\nAvailable options include:\n\tMap Layers & Legend\n\t<something> Resource Report \n\tFeature Search\n\tAddress\n\tDraw, Label, & Measure\n\tBookmark\n\tFind a Place\n\tPrint\n\tSettings\n\tIdentify\n Edit javascript/readConfig.js to change this.","Data Error"))}}var m=new S({title:"<img id='printIcon' role='presentation' src='assets/images/i_print.png'/> Print",open:i,content:document.getElementById("printContent")});m.startup(),document.getElementById("printDiv").appendChild(m.domNode),document.getElementById("printHelpBtn").addEventListener("click",function(){show("printHelpDialog")}),null==n&&alert("Warning: Missing help video in "+app+"/config.xml file for widget print.","Data Error"),e.byId("printDiv").style.display="block",e.byId("printDiv").style.visibility="visible",printInit(),-1==r.indexOf("Map Layers & Legend")?e.byId("tocPane").style.display="none":-1==r.indexOf("Resource Report")?e.byId("reportDiv").style.display="none":-1==r.indexOf("Feature Search")?e.byId("searchDiv").style.display="none":-1==r.indexOf("Address")?e.byId("addressDiv").style.display="none":-1==r.indexOf("Draw, Label, & Measure")?e.byId("drawDiv").style.display="none":-1==r.indexOf("Bookmark")?e.byId("bookmarkDiv").style.display="none":-1==r.indexOf("Settings")&&(e.byId("settingsDiv").style.display="none");for(var b='<span class="link"><a href="'+app+'/help.html" target="help"><img src="assets/images/i_help.png"/>Help</a></span>',f=V.getElementsByTagName("links")[0].getElementsByTagName("link"),v="",w=0;w<f.length;w++)"Go Mobile"!=f[w].getAttribute("label")&&("Buy License!"==f[w].getAttribute("label")?(v=f[w].getAttribute("url").replace("%3F","?").replace("%26","&"),b+='<span class="link"><a id="licenseLink"><img src="'+f[w].getAttribute("icon")+'"/>'+f[w].getAttribute("label")+"</a></span>"):b+='<span class="link"><a href="'+f[w].getAttribute("url").replace("%3F","?").replace("%26","&")+'" target="_new"><img src="'+f[w].getAttribute("icon")+'"/>'+f[w].getAttribute("label")+"</a></span>");e.byId("links").innerHTML=b,document.getElementById("licenseLink")&&document.getElementById("licenseLink").addEventListener("click",function(){window.open(v,"_new"),"function"==typeof gtag&&gtag("event","widget_click",{widget_name:"Buy License"})})})}function G(){var e="disclaimer",t=createXMLhttpRequest(),r=app+"/PrintPdfWidget.xml?v="+ndisVer;t.onreadystatechange=function(){if(4===t.readyState&&200===t.status){var r=createXMLdoc(t);r.getElementsByTagName("disclaimer")[0]?e=r.getElementsByTagName("disclaimer")[0].firstChild.nodeValue:alert("Missing tag, disclaimer, in "+app+"/PrintPdfWidget.xml file.","Data Error"),r.getElementsByTagName("helpvideo")[0]&&(document.getElementById("printVideo").innerHTML="<a target='help' href="+r.getElementsByTagName("helpvideo")[0].firstChild.nodeValue+">Click here to view help video.</a><br/><br/>"),P(e)}else 404===t.status?alert("Cannot add print widget. Missing PrintPdfWidget.aspx file in "+app+" directory.","Data Error"):4===t.readyState&&500===t.status&&alert("Cannot add print widget. Missing PrintPdfWidget.aspx file in "+app+" directory.","Data Error")},t.open("GET",r,!0),t.send()}function P(e){const t=new y({view:view,allowedFormats:["pdf","jpg"],allowedLayouts:["Letter ANSI A landscape","Letter ANSI A portrait","Tabloid ANSI B landscape","Tabloid ANSI B portrait"],templateOptions:{author:e,legendEnabled:!0,dpi:300},templateCustomTextElements:{Subtitle:"subtitle"}}),r=new f({view:view,content:t,expandTooltip:"Print",expandIconClass:"esri-icon-printer"});view.ui.add(r,"top-right")}function U(){var e=new s({url:"https://ndismaps.nrel.colostate.edu/ArcGIS/rest/services/HuntingAtlas/HuntingAtlas_FindAPlaceTool_Data/MapServer/1"}),t=new s({url:"https://ndismaps.nrel.colostate.edu/ArcGIS/rest/services/HuntingAtlas/HuntingAtlas_AssetReport_Data/MapServer/3"}),r=new s({url:"https://ndismaps.nrel.colostate.edu/ArcGIS/rest/services/HuntingAtlas/HuntingAtlas_FindAPlaceTool_Data/MapServer/4"}),a=new s({url:"https://ndismaps.nrel.colostate.edu/ArcGIS/rest/services/HuntingAtlas/HuntingAtlas_AssetReport_Data/MapServer/5"}),i=new s({url:"https://ndismaps.nrel.colostate.edu/ArcGIS/rest/services/HuntingAtlas/HuntingAtlas_AssetReport_Data/MapServer/4"});X=new E({view:view,includeDefaultSources:!1,searchAllEnabled:!0,popupEnabled:!1,locationEnabled:!1,resultGraphicEnabled:!1,maxResults:6,maxSuggestions:50,suggestionsEnabled:!0,minSuggestCharacters:2,allPlaceholder:"Search",sources:[{url:myFindService,singleLineFieldName:"SingleLine",outFields:["*"],name:"Colorado Places",placeholder:"Search Colorado Places"},{layer:e,searchFields:["COUNTYNAME"],displayField:"COUNTYNAME",exactMatch:!1,outFields:["COUNTYNAME"],name:"County Boundaries (Douglas)",placeholder:"Search Counties"},{layer:t,searchFields:["PropName"],displayField:"PropName",exactMatch:!1,maxSuggestions:1e3,outFields:["PropName"],name:"CPW Properties Boundaries (STL, SWA, SFU, or WWA)",placeholder:"Search CPW Properties"},{layer:r,searchFields:["GMUID"],displayField:"GMUID",exactMatch:!1,maxResults:6,maxSuggestions:100,minSuggestCharacters:1,outFields:["GMUID"],name:"GMU Boundaries (38)",placeholder:"Search GMUs"},{layer:a,searchFields:["MapName"],displayField:"MapName",exactMatch:!1,outFields:["MapName"],name:"Forest or Grassland Boundaries",placeholder:"Search Forests/Grasslands"},{layer:i,searchFields:["NAME"],displayField:"NAME",exactMatch:!1,outFields:["NAME"],name:"Wilderness Boundaries",placeholder:"Search Wildernesses"},{url:"https://geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer/",singleLineFieldName:"SingleLine",outFields:["*"],name:"Address",placeholder:"Search Address"}]}),X.goToOverride=function(e,t){return null},X.on("search-complete",function(e){for(var t=!0,r=0;r<e.results.length;r++)if(0!=e.results[r].results.length){t=!1;break}if(t)return void alert(e.searchTerm+" was not found. Please try your search again.","Note");var a=0;for(r=0;r<e.results.length;r++)if(0!=e.results[r].results.length){var i=e.results[r].results[0].name.toLowerCase();if(e.searchTerm.toLowerCase()===i.substring(0,i.indexOf(","))||e.searchTerm.toLowerCase()===i){a=r;break}}const l=e.results[a];var n,s=l.results[0].extent;for(r=0;r<l.results.length;r++)if("point"===l.results[r].feature.geometry.type)require(["esri/geometry/Point"],function(e){n=new e(l.results[r].feature.geometry.x,l.results[r].feature.geometry.y,l.results[r].feature.geometry.spatialReference),addTempPoint(n),Q?(addTempLabel(n,queryObj.label),Q=!1):addTempLabel(n,l.results[r].name)});else if("polygon"===l.results[r].feature.geometry.type){if(addTempPolygon(l.results[r].feature),Q)addTempLabel(l.results[r].feature,queryObj.label),Q=!1;else if(l.results[r].feature.sourceLayer.title.indexOf("GMU")>-1)addTempLabel(l.results[r].feature,"GMU "+l.results[r].name);else if(l.results[r].feature.sourceLayer.title.indexOf("County")>-1){var o=l.results[r].name.toLowerCase(),p=o.substring(0,1).toUpperCase();o=p+o.substring(1)+" County",addTempLabel(l.results[r].feature,o)}else addTempLabel(l.results[r].feature,l.results[r].name);var u=l.results[r].feature.geometry.extent;s=s.union(u)}this.clear(),"point"===l.results[0].feature.geometry.type?view.goTo({center:n,zoom:11}):view.extent=s}),view.ui.add(X,{position:"top-right",index:2})}function W(){const e=new d({basemap:"streets"}),t=(document.getElementById("overviewDiv"),document.getElementById("overviewContainer"));ee=new c({container:"overviewDiv",map:e,extent:fullExtent,constraints:{rotationEnabled:!1}}),ee.when(()=>{F()});const a=new f({view:view,content:t,id:"overviewBtn",expandTooltip:"Overview Map",expandIconClass:"esri-icon-overview-arrow-bottom-right",label:"Show Overview"});view.ui.add(a,"top-left"),te=r.debounce(()=>{view.stationary&&ee.goTo({center:view.center,scale:2*view.scale*Math.max(view.width/ee.width,view.height/ee.height)})})}function F(){var e,t,r,i;let l,n;$=new g({geometry:null,symbol:{type:"simple-fill",color:[0,0,0,.5],outline:null}}),ee.graphics.add($),document.getElementById("OVtitle").style.display="block",ee.popup.dockEnabled=!0,ee.popup.actions=[],ee.ui.components=[],ee.on("mouse-wheel",function(e){"hidden"!=overviewDiv.style.visibility&&e.stopPropagation()}),ee.on("double-click",function(e){"hidden"!=overviewDiv.style.visibility&&e.stopPropagation()}),ee.on("double-click",["Control"],function(e){"hidden"!=overviewDiv.style.visibility&&e.stopPropagation()}),ee.on("drag",a=>{if("hidden"!=overviewDiv.style.visibility)if("start"===a.action&&ee.hitTest(a).then(t=>{t.results.length>0&&t.results[0].graphic&&t.results[0].graphic.geometry&&"extent"===t.results[0].graphic.geometry.type&&(a.stopPropagation(),re=!0,console.log("start dragging"),n=t.results[0].graphic,e=ee.toMap({x:a.x,y:a.y}))}),"update"===a.action){if(n){a.stopPropagation(),console.log("update dragging"),l?ee.graphics.remove(l):ee.graphics.remove(n),l=n.clone(),t=ee.toMap({x:a.x,y:a.y}),r=t.x-e.x,i=t.y-e.y,e=t;const s=$.geometry;s.xmin+=r,s.xmax+=r,s.ymin+=i,s.ymax+=i,l.geometry=s,ee.graphics.add(l)}}else"end"===a.action&&n&&(a.stopPropagation(),console.log("end dragging"),l&&ee.graphics.remove(l),n&&ee.graphics.remove(n),$=n.clone(),$.geometry=l?l.geometry.clone():n.geometry.clone(),ee.graphics.add($),n=null,l=null,view.center=$.geometry.extent.center,re=!1)}),ee.on("drag",["Shift"],function(e){console.log("shift-drag"),"hidden"!=overviewDiv.style.visibility&&e.stopPropagation()}),ee.on("drag",["Shift","Control"],function(e){"hidden"!=overviewDiv.style.visibility&&e.stopPropagation()}),ee.on("key-down",e=>{if("hidden"==overviewDiv.style.visibility)return;const t=["+","-","Shift","_","=","ArrowUp","ArrowDown","ArrowRight","ArrowLeft"],r=e.key;-1!==t.indexOf(r)&&e.stopPropagation()}),a.watch(()=>view.extent,e=>{re||(te().then(()=>{$.geometry=e}),ee.scale=2*view.scale*Math.max(view.width/ee.width,view.height/ee.height),ee.center=view.center)},{initial:!0})}function R(){require(["dojo/dom","dijit/registry","dojo/sniff","dojo/on"],function(e,t,r,i){function l(){if(queryObj.extent&&""!=queryObj.extent){var e,t=[];t="[object Array]"===Object.prototype.toString.call(queryObj.extent)?queryObj.extent[0].split(","):queryObj.extent.split(","),e=queryObj.prj&&""!=queryObj.prj?queryObj.prj:t[0]<0&&t[0]>-200?4326:26913,H=new m({xmin:parseFloat(t[0]),ymin:parseFloat(t[1]),xmax:parseFloat(t[2]),ymax:parseFloat(t[3]),spatialReference:{wkid:parseInt(e)}});var r=new O;r.geometries=[H],r.outSpatialReference=new u(wkid),p.project(geometryService,r).then(e=>{initExtent=e[0],view.extent=initExtent}).catch(r=>{let a="There was a problem converting the extent read from the URL to Web Mercator projection. extent="+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+"  prj="+e+"  "+r.message;alert(a,"URL Extent Error",r)})}else initExtent=new m({xmin:parseFloat(H[0]),ymin:parseFloat(H[1]),xmax:parseFloat(H[2]),ymax:parseFloat(H[3]),spatialReference:{wkid:wkid}}),view.extent=initExtent;if(queryObj.place&&""!=queryObj.place){var a=queryObj.place.replace("%20"," ");queryObj.prj&&""!=queryObj.prj&&(settings={XYProjection:queryObj.prj});var i="0123456789-";i.indexOf(a.substring(0,1))>-1&&a.indexOf(",")>-1?handleCoordinate(a):(0==a.toLowerCase().indexOf("gmu ")&&(a=a.substring(4)),a.toLowerCase().indexOf(" county")>-1&&(a=a.substring(0,a.length-7)),queryObj.label&&(Q=!0),X.search(a))}
queryObj.keyword&&""!=queryObj.keyword&&(queryObj.value&&""!=queryObj.value?require(["esri/rest/query","esri/rest/support/Query"],function(e,t){var r=app+"/url.xml?v="+ndisVer,a=createXMLhttpRequest();a.onreadystatechange=function(){if(4==a.readyState&&200===a.status){for(var r=createXMLdoc(a),i=r.getElementsByTagName("layer"),l=0;l<i.length&&(i[l].getElementsByTagName("keyword")[0]&&i[l].getElementsByTagName("keyword")[0].firstChild||alert("Missing tag keyword or blank, in "+app+"/url.xml file.","Data Error"),queryObj.keyword!=i[l].getElementsByTagName("keyword")[0].firstChild.nodeValue);l++);if(l==i.length)alert("Keyword ["+queryObj.keyword+"] is not defined in "+app+"/url.xml file.","Data Error");else if(i[l].getElementsByTagName("url")[0]&&i[l].getElementsByTagName("url")[0].firstChild||alert("Missing tag url or blank, in "+app+"/url.xml file for keyword: "+queryObj.keyword+".","Data Error"),i[l].getElementsByTagName("expression")[0]&&i[l].getElementsByTagName("expression")[0].firstChild){var n=i[l].getElementsByTagName("expression")[0].firstChild.nodeValue.replace("[value]",queryObj.value);const r=new t({returnGeometry:!0,where:n});e.executeQueryJSON(i[l].getElementsByTagName("url")[0].firstChild.nodeValue,r).then(e=>{0==e.features.length?gotoLocation(queryObj.value,!0):require(["esri/geometry/Point","esri/Graphic"],function(t,r){var a;if("point"===e.geometryType){var n=8;i[l].getElementsByTagName("mapscale")[0]&&i[l].getElementsByTagName("mapscale")[0].firstChild&&(n=parseInt(i[l].getElementsByTagName("mapscale")[0].firstChild.nodeValue)),n>11&&(n=8),a=new t(e.features[0].geometry.x,e.features[0].geometry.y,e.spatialReference),view.goTo({center:a,zoom:n}),addTempPoint(a),queryObj.label&&""!=queryObj.label&&addTempLabel(a,queryObj.label)}else if("polygon"===e.geometryType){var s=!1;if(i[l].getElementsByTagName("union")[0]&&i[l].getElementsByTagName("union")[0].firstChild&&"true"===i[l].getElementsByTagName("union")[0].firstChild.nodeValue.toLowerCase()&&(s=!0),s){for(var o=e.features[0].geometry.extent,p=0;p<e.features.length;p++){var u=e.features[p].geometry.extent;o=o.union(u),addTempPolygon(e.features[p]),queryObj.label&&""!=queryObj.label&&addTempLabel(e.features[p],queryObj.label)}view.extent=o}else a=e.features[0].geometry.centroid,view.extent=e.features[0].geometry.extent,addTempPolygon(e.features[0])}else view.extent=e.features[0].geometry.extent,poly[0]=new r({geometry:view.extent,symbol:polySymbol}),view.graphics.add(poly[0]),setTimeout(function(){view.graphics.remove(poly[0])},1e4),a=view.extent.center,queryObj.label&&""!=queryObj.label&&addTempLabel(a,queryObj.label,12)})}).catch(e=>{e.responseText?alert("Error: Failed to zoom to keyword="+queryObj.keyword+" value="+queryObj.value+" "+e.message+e.responseText,"URL Keyword/Value Error",e):alert("Error: Failed to zoom to keyword="+queryObj.keyword+" value="+queryObj.value+" "+e.message,"URL Keyword/Value Error",e)})}else alert("Missing tag expression, in "+app+"/url.xml file for keyword: "+queryObj.keyword,"Data Error")}else 404===a.status?alert("Missing url.xml file in "+app+" directory.","Data Error"):4===a.readyState&&500===a.status&&alert("Error: had trouble reading "+app+"/url.xml file in readConfig.js.","Data Error")},a.open("GET",r,!0),a.send(null)}):alert("When &keyword is used on the URL, there must be a &value also.","URL Keyword/Value Error")),queryObj.map&&""!=queryObj.map&&(queryObj.value&&""!=queryObj.value&&queryObj.field&&""!=queryObj.field?require(["esri/request","esri/tasks/QueryTask","esri/tasks/query"],function(e,t,r){var a=new t(queryObj.map),i=new r;Number(queryObj.value)?i.where=queryObj.field+"="+queryObj.value:i.where="UPPER("+queryObj.field+") LIKE UPPER('"+queryObj.value+"')",i.returnGeometry=!0,a.execute(i,function(e){require(["esri/geometry/Point","esri/graphicsUtils"],function(t,r){0==e.features.length?alert("Cannot zoom to "+queryObj.value+". The feature was not found in "+queryObj.map+" for field "+queryObj.field,"URL Map/Value Error"):"esriGeometryPoint"==e.geometryType?map.centerAndZoom(new t(e.features[0].geometry.x,e.features[0].geometry.y,e.spatialReference),8):map.setExtent(e.features[0].geometry.getExtent(),!0)})},function(e){e.responseText?alert("Error: QueryTask failed for map="+queryObj.map+" "+e.message+e.responseText,"URL Map/Value Error",e):alert("Error: QueryTask failed for map="+queryObj.map+" "+e.message,"URL Map/Value Error",e)})}):alert("When &map is used on the URL, there must also be an &field and &value.","URL Map/Value Error"))}try{if(mapBasemap="streets",queryObj.layer&&""!=queryObj.layer){var n=queryObj.layer.substring(0,queryObj.layer.indexOf("|")).split(",");0==n[0]?mapBasemap="streets":1==n[0]?mapBasemap="hybrid":2==n[0]?mapBasemap="topo-vector":mapBasemap=n[0],n=null}var s=[{level:6,resolution:2445.98490512499,scale:9244648.868618},{level:7,resolution:1222.992452562495,scale:4622324.434309},{level:8,resolution:611.4962262813797,scale:2311162.217155},{level:9,resolution:305.74811314055756,scale:1155581.108577},{level:10,resolution:152.87405657041106,scale:577790.554289},{level:11,resolution:76.43702828507324,scale:288895.277144},{level:12,resolution:38.21851414253662,scale:144447.638572},{level:13,resolution:19.10925707126831,scale:72223.819286},{level:14,resolution:9.554628535634155,scale:36111.909643},{level:15,resolution:4.77731426794937,scale:18055.954822},{level:16,resolution:2.388657133974685,scale:9027.977411},{level:17,resolution:1.1943285668550503,scale:4513.988705},{level:18,resolution:.5971642835598172,scale:2256.994353},{level:19,resolution:.29858214164761665,scale:1128.497176}];map=new d({basemap:mapBasemap,lods:s}),view=new c({container:"mapDiv",extent:fullExtent,map:map,constraints:{maxScale:9244649,minScale:1128}})}catch(e){alert("Error creating map in readConfig.js addMap. "+e.message,"Code Error",e)}view.when(()=>{view.on("pointer-move",e=>{showCoordinates(e)}),view.on("click",e=>{console.log("Identify")}),a.watch(()=>view.zoom,e=>{showMapScale(parseInt(view.scale))},{initial:!0}),view.on("update-start",showLoading),view.on("update-end",hideLoading),showMapScale(view.scale),C();let e=new v({view:view});const t=new f({view:view,content:e,expandTooltip:"Legend",expandIconClass:"esri-icon-legend"});view.ui.add(t,"top-right"),t.when(()=>{var e=document.createElement("h3");e.className="dialogTitle",e.style.margin=0,e.style.padding="10px",e.style.position="sticky",e.style.top="0px",e.style.position="-webkit-sticky",e.style.zIndex=1,e.innerHTML="Legend";const t=document.getElementsByClassName("esri-legend")[0];t.insertBefore(e,t.firstChild)});try{let e=new J;z=new f({view:view,content:e,expandTooltip:"Basemap",expandIconClass:"esri-icon-basemap"}),view.ui.add(z,"top-right"),z.when(()=>{var e=document.createElement("h3");e.className="dialogTitle",e.style.margin=0,e.style.padding="10px",e.style.position="sticky",e.style.top="0px",e.style.position="-webkit-sticky",e.style.zIndex=1,e.innerHTML="Basemaps";const t=document.getElementById("bmGallery");t.insertBefore(e,t.firstChild)})}catch(e){alert("Problem creating basemaps. Error message: "+e.getMessage,"Error")}let r=new x({view:view,unit:"dual"});view.ui.add(r,"bottom-left");const i=new b({view:view,expandTooltip:"Full Extent"});view.ui.add(i,"top-left");const n=new w({view:view});view.ui.add(n,"top-left"),l()})})}var V,H;openTOCgroups=[];var z,Z,X,K={},Q=!1;if(screen.width<768){var Y=document.getElementById("title").innerHTML;Y.indexOf("Colorado")>-1&&(Y="CO "+Y.substring(Y.indexOf(" ")+1),document.getElementById("title").innerHTML=Y)}class J{constructor(){try{return this.setupLayers(),this.menu=document.createElement("ul"),this.bmGallery=document.createElement("div"),this.bmGallery.style.backgroundColor="#fff",this.bmGallery.className="esri-legend",this.bmGallery.appendChild(this.menu),this.menu.role="menu",this.bmGallery.id="bmGallery",this.add("streets","Streets","assets/images/streets_thumb.jpg",!0),this.add("aerial","Aerial Photo","assets/images/aerial_thumb.jpg",!1),this.add("topo","USGS Scanned Topo","assets/images/USA_topo.png",!1),this.add("natgeo","USGS Digital Topo","assets/images/natgeothumb.jpg",!1),this.add("imagery_topo","Aerial Photo with USGS Contours","assets/images/aerial_topo.png",!1),this.add("topo2","ESRI Digital Topo","assets/images/topo2_thumb.jpg",!1),this.bmGallery}catch(e){alert("Error in myBasemapGallery. "+e.getMessage,"Error")}}setupLayers(){require(["esri/Basemap","esri/layers/VectorTileLayer","esri/layers/MapImageLayer","esri/layers/FeatureLayer"],(e,t,r,a)=>{var i;i=new r({url:"https://services.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer"}),streets=new e({baseLayers:[i],title:"Streets",id:"streets",thumbnailUrl:"https://www.arcgis.com/sharing/rest/content/items/2ea9c9cf54cb494187b03a5057d1a830/info/thumbnail/Jhbrid_thumb_b2.jpg"});var l=[];i=new r({url:"https://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer"}),l.push(i),i=new t({url:"https://www.arcgis.com/sharing/rest/content/items/30d6b8271e1849cd9c3042060001f425/resources/styles/root.json"}),l.push(i),aerial=new e({baseLayers:l,title:"Aerial Photo",id:"aerial",thumbnailUrl:"https://www.arcgis.com/sharing/rest/content/items/f81bc478e12c4f1691d0d7ab6361f5a6/info/thumbnail/street_thumb_b2wm.jpg"}),i=new r({url:"https://basemap.nationalmap.gov/arcgis/rest/services/USGSTopo/MapServer"}),natgeo=new e({baseLayers:[i],title:"USGS Digital Topo",id:"natgeo",thumbnailUrl:"https://usfs.maps.arcgis.com/sharing/rest/content/items/6d9fa6d159ae4a1f80b9e296ed300767/info/thumbnail/thumbnail.jpeg"}),i=new r({url:"https://services.arcgisonline.com/ArcGIS/rest/services/USA_Topo_Maps/MapServer",dpi:300}),topo=new e({baseLayers:[i],title:"USGS Scanned Topo",id:"topo",thumbnailUrl:"assets/images/USA_topo.png"}),i=new r({url:"https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryTopo/MapServer",dpi:300}),imagery_topo=new e({baseLayers:[i],title:"Aerial Photo with USGS Contours",id:"imagery_topo",dpi:300,thumbnailUrl:"assets/images/aerial_topo.png"}),i=new r({url:"https://services.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer"}),topo2=new e({baseLayers:[i],title:"ESRI Digital Topo",id:"topo2",thumbnailUrl:"https://www.arcgis.com/sharing/rest/content/items/588f0e0acc514c11bc7c898fed9fc651/info/thumbnail/topo_thumb_b2wm.jpg"})})}add(e,t,r,a){const i=document.createElement("li");i.id=e,i.className=a?"bmSelected":"bmUnselected",i.ariaSelected="true",i.role="menu-item",i.title=t;const l=document.createElement("img");l.src=r,l.addEventListener("click",this.toggleBasemap),l.id=e,i.appendChild(l);const n=document.createElement("div");n.style.textAlign="center",n.innerHTML=t,n.id=e,i.appendChild(n),this.menu.appendChild(i)}toggleBasemap(e){const t=e.target.id;document.getElementsByClassName("bmSelected")[0].className="bmUnselected",document.getElementById(t).className="bmSelected",map.basemap=window[t],z.expanded=!1}}var $,ee,te,re=!1;try{var ae=getCookie("xycoords");document.getElementById("xycoords_combo").value=""==ae?"dms":ae;var ie,le=document.location.search.replace(/\%0D/g,"newline");if(queryObj=t.queryToObject(le.substring("?"===le[0]?1:0)),queryObj.point&&(queryObj.point=queryObj.point.replace(/~/g," "),ie=/([^a-zA-Z0-9 °\-\'\"\|;,\.!_\*()\\])/g,ie.test(queryObj.point)&&alert("Illegal characters were removed from way point labels.","Warning"),ie=/([^a-zA-Z0-9 °\-\'\"\|;,\.!_\*()])/g,queryObj.point=queryObj.point.replace(ie,""),queryObj.point=queryObj.point.replace(/newline/g,"\n")),queryObj.line&&(ie=/([^a-zA-Z0-9 \-\'\|;,\.!_\*()\\])/g,ie.test(queryObj.line)&&alert("Illegal characters were removed from the line labels.","Warning"),ie=/([^a-zA-Z0-9 \-\'\|;,\.!_\*()])/g,queryObj.line=queryObj.line.replace(ie,"")),queryObj.poly&&(ie=/([^a-zA-Z0-9 \-\'\|;,\.!_\*()\\])/g,ie.test(queryObj.poly)&&alert("Illegal characters were removed from the shape (polygon) labels.","Warning"),ie=/([^a-zA-Z0-9 \-\'\|;,\.!_\*()])/g,queryObj.poly=queryObj.poly.replace(ie,"")),queryObj.rect&&(ie=/([^a-zA-Z0-9 \-\'\|;,\.!_\*()\\])/g,ie.test(queryObj.rect)&&alert("Illegal characters were removed from the rectangle labels.","Warning"),ie=/([^a-zA-Z0-9 \-\'\|;,\.!_\*()])/g,queryObj.rect=queryObj.rect.replace(ie,"")),queryObj.text&&(ie=/([^a-zA-Z0-9 \-\'\|;,\.!_\*()\\])/g,ie.test(queryObj.text)&&alert("Illegal characters were removed from the point labels.","Warning"),ie=/([^a-zA-Z0-9 \-\'\|;,\.!_\*()])/g,queryObj.text=queryObj.text.replace(ie,"")),queryObj.layer&&(queryObj.layer=queryObj.layer.replace(/~/g," "),ie=/([^a-zA-Z0-9 \-\|,\._()])/g,ie.test(queryObj.layer)&&alert("Illegal characters were found on the URL. Layers may not load properly.","Warning"),queryObj.layer=queryObj.layer.replace(ie,"")),queryObj.keyword&&(ie=/([^a-zA-Z0-9 \-\._()])/g,ie.test(queryObj.keyword)&&alert("Illegal characters were found on the URL. Location may not load properly.","Warning"),queryObj.keyword=queryObj.keyword.replace(ie,"")),queryObj.value){ie=/([^a-zA-Z0-9 \-\',\.!_\*()\\#/&])/g,ie.test(queryObj.value)&&alert("Illegal characters were found on the URL. Location may not load properly.","Warning"),ie=/([^a-zA-Z0-9 \-\',\.!_\*()#/&])/g,queryObj.value=queryObj.value.replace(ie,"");var ne=/'/g;queryObj.value=queryObj.value.replace(ne,"''")}queryObj.label&&(ie=/([^a-zA-Z0-9 \-\',\.!_\*()#&/\\])/g,ie.test(queryObj.label)&&alert("Illegal characters were found on the URL. Point labels may not load properly.","Warning"),ie=/([^a-zA-Z0-9 \-\',\.!_\*()#&/])/g,queryObj.label=queryObj.label.replace(ie,"")),queryObj.map&&(ie=/([^a-zA-Z0-9 \-,\._():\/])/g,ie.test(queryObj.map)&&alert("Illegal characters were found on the URL. Map may not load properly.","Warning"),queryObj.map=queryObj.map.replace(ie,"")),queryObj.field&&(ie=/([^a-zA-Z0-9 \-_])/g,ie.test(queryObj.field)&&alert("Illegal characters were found on the URL. Map may not load properly.","Warning"),queryObj.field=queryObj.field.replace(ie,"")),queryObj.prj&&isNaN(queryObj.prj)&&(queryObj.prj=102100,alert("Problem reading map projection from the URL, defaulting to WGS84.","Warning")),queryObj.extent&&(ie=/([^0-9 \-,\.])/g,ie.test(queryObj.extent)&&alert("Illegal characters were found on the URL. Map extent may not load properly.","Warning"),queryObj.extent=queryObj.extent.replace(ie,"")),queryObj.place&&(ie=/([^a-zA-Z0-9 \-\',\.!_*():#&/\\])/g,ie.test(queryObj.place)&&alert("Illegal characters were found on the URL. Location may not load properly.","Warning"),ie=/([^a-zA-Z0-9 \-\',\.!_*():#&/])/g,queryObj.place=queryObj.place.replace(ie,"")),document.getElementById("mapDescFile").href=app+"/definitions.html";var se=createXMLhttpRequest(),oe=app+"/config.xml?v="+ndisVer;se.onreadystatechange=function(){if(4==se.readyState&&200===se.status){V=createXMLdoc(se);try{geometryService=V.getElementsByTagName("geometryservice")[0].getAttribute("url")}catch(e){alert("Missing tag: geometryservice in "+app+'/config.xml.\n\nTag should look like: &lt;geometryservice url="https://ndismaps.nrel.colostate.edu/ArcGIS/rest/services/Utilities/Geometry/GeometryServer"/&gt;\n\nWill use that url for now.',"Data Error"),geometryService="https://ndismaps.nrel.colostate.edu/ArcGIS/rest/services/Utilities/Geometry/GeometryServer"}try{printServiceUrl=V.getElementsByTagName("printservice")[0].firstChild.nodeValue}catch(e){alert("Missing tag: printservice in "+app+"/config.xml.\n\nTag should look like: &lt;printservice&gt;https://ndismaps.nrel.colostate.edu/arcgis/rest/services/Utilities/PrintingTools/GPServer/Export%20Web%20Map%20Task&lt;/printservice&gt;\n\nWill use that url for now.","Data Error"),printServiceUrl="https://ndismaps.nrel.colostate.edu/arcgis/rest/services/Utilities/PrintingTools/GPServer/Export%20Web%20Map%20Task"}try{printGeoServiceUrl=V.getElementsByTagName("printservicegeo")[0].firstChild.nodeValue}catch(e){alert("Missing tag: printservicegeo in "+app+"/config.xml.\n\nTag should look like: &lt;printservicegeo&gt;https://ndismaps.nrel.colostate.edu/arcgis/rest/services/PrintTemplate/georefPrinting/GPServer/georefPrinting&lt;/printservice&gt;\n\nWill use that url for now.","Data Error"),printGeoServiceUrl="https://ndismaps.nrel.colostate.edu/arcgis/rest/services/PrintTemplate/georefPrinting/GPServer/georefPrinting"}var t;try{t=V.getElementsByTagName("title")[0].firstChild.nodeValue}catch(e){alert("Warning: Missing title tag in "+app+"/config.xml file. "+e.message,"Data Error")}try{e.byId("title").innerHTML=t,document.title=t,e.byId("subtitle").innerHTML=V.getElementsByTagName("subtitle")[0].firstChild.nodeValue,e.byId("logo").src=V.getElementsByTagName("logo")[0].firstChild.nodeValue,e.byId("logourl").href=V.getElementsByTagName("logourl")[0].firstChild.nodeValue}catch(e){alert("Warning: Missing title, subtitle, logo, or logurl tag in "+app+"/config.xml file. "+e.message,"Data Error")}V.getElementsByTagName("noDisclaimer")&&V.getElementsByTagName("noDisclaimer")[0]&&"true"==V.getElementsByTagName("noDisclaimer")[0].firstChild.nodeValue||1!=getCookie("noDisclaimer")&&loadDisclaimer(t);try{myFindService=V.getElementsByTagName("findplaceservice")[0].getAttribute("url")}catch(e){alert("Missing tag: findplaceservice in "+app+'/config.xml.\n\nTag should look like: &lt;findplaceservice url="https://ndismaps.nrel.colostate.edu/ArcGIS/rest/services/GNIS_Loc/GeocodeServer"/&gt;\n\nWill use that url for now.',"Data Error"),myFindService="https://ndismaps.nrel.colostate.edu/ArcGIS/rest/services/GNIS_Loc/GeocodeServer"}try{H=V.getElementsByTagName("map")[0].getAttribute("initialextent").split(" "),wkid=parseInt(V.getElementsByTagName("map")[0].getAttribute("wkid").trim()),fullExtent=new m({xmin:parseFloat(H[0]),ymin:parseFloat(H[1]),xmax:parseFloat(H[2]),ymax:parseFloat(H[3]),spatialReference:{wkid:wkid}})}catch(e){alert("Warning: Missing tag attributes initalextent or wkid for the map tag in "+app+"/config.xml file. "+e.message,"Data Error")}R(),W(),U(),G(),hideLoading()}else 404===se.status?(alert("Error: Missing config.xml file in "+app+" directory.","Data Error"),hideLoading()):4===se.readyState&&500===se.status&&(alert("Make sure your application name is correct on the URL. app="+app,"Warning"),hideLoading())},se.open("GET",oe,!0),se.send(null)}catch(e){alert("Error in javascript/readConfig.js. "+e.message,"Code Error",e)}})}var locator,layerObj,addressGraphicsCount=[],addressGraphicsCounter=0;