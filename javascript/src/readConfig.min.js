function lookupAddress(){require(["dojo/dom"],function(e){"function"==typeof ga&&ga("send","event","address","click","Address","1");var t=e.byId("streetTxt").value,r=/([^a-zA-Z0-9 \-\',\.()])/g;if(r.test(t))return t=t.replace(r,""),e.byId("streetTxt").value=t,void alert("Illegal characters were removed from the address.","Warning");var a=e.byId("cityTxt").value;if(r=/([^a-zA-Z0-9 \-\'()])/g,r.test(a))return a=a.replace(r,""),e.byId("cityTxt").value=a,void alert("Illegal characters were removed from the city.","Warning");var i=e.byId("zipTxt").value;if(r=/([^0-9 \-])/g,r.test(i))return i=i.replace(r,""),e.byId("zipTxt").value=i,void alert("Illegal characters were removed from the zip code.","Warning");""!==t&&""!==a?require(["esri/geometry/Extent"],function(r){showLoading(),e.byId("addressLoading").style.display="block";var n={Address:t,City:a,Region:"CO",Postal:i};locator.outSpatialReference=map.spatialReference;var l=new r({xmin:-1235e4,ymin:425e4,xmax:-1115e4,ymax:525e4,spatialReference:{wkid:wkid}}),s={address:n,searchExtent:l};locator.addressToLocations(s,onAddressResults,onAddressFault)}):(hideLoading(),e.byId("addressLoading").style.display="none",alert("Street and City are required fields.","Warning"))})}function onAddressResults(e){try{require(["dojo/dom","esri/symbols/SimpleMarkerSymbol","esri/symbols/PictureMarkerSymbol","esri/graphic","esri/symbols/Font","esri/symbols/TextSymbol","dojo/_base/Color"],function(t,r,a,i,n,l,s){hideLoading(),t.byId("addressLoading").style.display="none";var o,d=new a("assets/images/i_address.png",30,30);return e.every(function(e){var t;e.score>40&&require(["esri/layers/GraphicsLayer","dojo/_base/Color"],function(r,a){o=e.location,t=new r,t.id="addressgraphics"+addressGraphicsCounter,addressGraphicsCount.push(t.id),addressGraphicsCounter++,t.add(new i(o,d));var s=e.address,y=new n("10pt",n.STYLE_NORMAL,n.VARIANT_NORMAL,n.WEIGHT_BOLD,"Helvetica"),c=new a([255,255,153,255]),u=new l(s,y,new a("#000000"));u.setOffset(0,-23);var g=new esri.symbol.TextSymbol(s,y,c);g.setOffset(1,-25);var p=new esri.symbol.TextSymbol(s,y,c);p.setOffset(0,-24);var m=new esri.symbol.TextSymbol(s,y,c);m.setOffset(0,-22);var b=new esri.symbol.TextSymbol(s,y,c);b.setOffset(-1,-21);var f=new esri.symbol.TextSymbol(s,y,c);f.setOffset(2,-23);var v=new esri.symbol.TextSymbol(s,y,c);return v.setOffset(-2,-23),t.add(new esri.Graphic(o,g)),t.add(new esri.Graphic(o,p)),t.add(new esri.Graphic(o,m)),t.add(new esri.Graphic(o,b)),t.add(new esri.Graphic(o,f)),t.add(new esri.Graphic(o,v)),t.add(new i(o,u)),map.addLayer(t),!1})}),void 0!==o?(map.centerAndZoom(o,6),!0):(alert("Address was not found.","Note"),!1)})}catch(e){return alert("Error looking up address: "+e.message,"Code Error",e),!1}}function onAddressFault(e){require(["dojo/dom"],function(t){hideLoading(),t.byId("addressLoading").style.display="none",alert("Error occurred searching for address. Address service may be down. Service name is: "+locator.url+". "+e.message,"Code Error",e)})}function clearAddress(){0!=addressGraphicsCount.length&&map.getLayer(addressGraphicsCount.pop()).clear()}function readConfig(){require(["dojo/dom","dojo/io-query","esri/core/promiseUtils","esri/core/reactiveUtils","esri/layers/MapImageLayer","esri/layers/FeatureLayer","esri/rest/geometryService","esri/geometry/SpatialReference","esri/Graphic","esri/Map","esri/views/MapView","esri/geometry/Extent","esri/widgets/Home","esri/widgets/Expand","esri/widgets/LayerList","esri/widgets/Legend","esri/widgets/ScaleBar","esri/widgets/Slider","esri/rest/support/ProjectParameters","esri/symbols/SimpleFillSymbol","dijit/form/CheckBox","dijit/layout/ContentPane","dijit/TitlePane","esri/symbols/SimpleLineSymbol","dojo/sniff"],function(e,t,r,a,n,l,s,o,d,y,c,u,g,p,m,b,f,v,h,w,O,E,x,q,I){function k(){function e(e){var a,i=e.getAttribute("label");if(D[i]++,queryObj.layer&&""!=queryObj.layer)if(e.getAttribute("url").toLowerCase().indexOf("mapserver")>-1)a=layerObj[i]?new n({url:e.getAttribute("url"),opacity:layerObj[i].opacity,title:i,visible:layerObj[i].visible,sublayers:layerObj[i].visLayers}):new n({url:e.getAttribute("url"),opacity:Number(e.getAttribute("alpha")),title:i,visible:!1});else{if(!(e.getAttribute("url").toLowerCase().indexOf("featureserver")>-1))return void alert("Unknown operational layer type. It must be of type MapServer or FeatureServer. Or edit readConfig.js line 600 to add new type.");a=layerObj[i]?new l({url:e.getAttribute("url"),opacity:Number(e.getAttribute("alpha")),title:i,visible:layerObj[i].visible}):new l({url:e.getAttribute("url"),opacity:Number(e.getAttribute("alpha")),title:i,visible:!1})}else if(e.getAttribute("url").toLowerCase().indexOf("mapserver")>-1)a="false"==e.getAttribute("visible")?new n({url:e.getAttribute("url"),opacity:Number(e.getAttribute("alpha")),title:i,visible:!1}):new n({url:e.getAttribute("url"),opacity:Number(e.getAttribute("alpha")),title:i,visible:!0});else{if(!(e.getAttribute("url").toLowerCase().indexOf("featureserver")>-1))return void alert("Unknown operational layer type. It must be of type MapServer or FeatureServer. Or edit readConfig.js line 600 to add new type.");a="false"==e.getAttribute("visible")?new l({url:e.getAttribute("url"),opacity:Number(e.getAttribute("alpha")),title:i,visible:!1}):new l({url:e.getAttribute("url"),opacity:Number(e.getAttribute("alpha")),title:i,visible:!0})}map.add(a),a.on("load",t),a.on("error",r)}function t(e){try{for(var t,r,a=[],i=0;i<S.getElementsByTagName("operationallayers")[0].getElementsByTagName("layer").length;i++)e.layer.id===S.getElementsByTagName("operationallayers")[0].getElementsByTagName("layer")[i].getAttribute("label")&&(r=S.getElementsByTagName("operationallayers")[0].getElementsByTagName("layer")[i]);if(M){t=!1,"false"==r.getAttribute("open")&&(t=!0);var n=r.getAttribute("opensublayer");n&&(a=n.split(",")),n=null}else{t=!0,e.layer.visible&&(t=!1);var l,s=new Array(0,1,2,3,4,5,6,7,8,9),o=[];if(layerObj[e.layer.id]){if(o=e.layer.layerInfos,"Hunter Reference"==e.layer.id){for(l=0;l<layerObj[e.layer.id].visLayers.length;l++)if(o[layerObj[e.layer.id].visLayers[l]].name.substr(o[layerObj[e.layer.id].visLayers[l]].name.length-3,3).indexOf("GMU")>-1){gmu=o[layerObj[e.layer.id].visLayers[l]].name;break}}else if("Game Species"==e.layer.id)for(l=0;l<layerObj[e.layer.id].visLayers.length;l++){if("Bighorn Sheep"===o[layerObj[e.layer.id].visLayers[l]].name){gmu="Bighorn GMU";break}if("Mountain Goat"===o[layerObj[e.layer.id].visLayers[l]].name){gmu="Goat GMU";break}}for(l=0;l<o.length;l++)-1!=layerObj[e.layer.id].visLayers.indexOf(o[l].id)?o[l].defaultVisibility=!0:-1==o[l].parentLayerId||o[l].subLayerIds?o[l].defaultVisibility=!1:o[l].name.substr(o[l].name.length-3,3).indexOf("GMU")>-1||1==o[l].defaultVisibility&&-1===layerObj[e.layer.id].visLayers.indexOf(o[l].parentLayerId)&&(layerObj[e.layer.id].visLayers.push(l),s.indexOf(parseInt(o[o[l].parentLayerId].name.substr(0,1)))>-1&&(layerObj[e.layer.id].visLayers.push(o[l].parentLayerId),o[o[l].parentLayerId].defaultVisibility=!0));e.layer.setVisibleLayers(layerObj[e.layer.id].visLayers.sort(function(e,t){return e-t})),e.layer.refresh()}}legendLayers.push({layer:e.layer,title:e.layer.id,autoToggle:!0,slider:!0,slider_ticks:3,slider_labels:["transparent","50%","opaque"],hideGroupSublayers:hideGroupSublayers,radioLayers:radioLayers,noLegend:!0,openSubLayers:a,collapsed:t}),map.addLayer(e.layer),a=null}catch(e){alert("Error in readConfig.js/layerLoadedHandler "+e.message,"Code Error",e)}}function r(t){for(var r,a=0;a<S.getElementsByTagName("operationallayers")[0].getElementsByTagName("layer").length;a++)if(S.getElementsByTagName("operationallayers")[0].getElementsByTagName("layer")[a].getAttribute("label")===t.target.id){r=S.getElementsByTagName("operationallayers")[0].getElementsByTagName("layer")[a];break}D[t.target.id]<5?setTimeout(function(){e(r)},2e3):5==D[t.target.id]?(t.target.id.indexOf("Motor Vehicle")>-1||t.target.id.indexOf("Wildfire")>-1||t.target.id.indexOf("BLM")>-1?alert("The external map service that provides "+t.target.id+" is experiencing problems.  This issue is out of CPW control. We will continue to try to load it. We apologize for any inconvenience.","External (Non-CPW) Map Service Error"):alert(t.target.id+" service is busy or not responding. We will continue to try to load it.","Data Error"),setTimeout(function(){e(r)},3e4)):setTimeout(function(){e(r)},3e4)}if(M=!0,queryObj.layer&&""!=queryObj.layer){M=!1;var a=queryObj.layer.substring(queryObj.layer.indexOf("|")+1).split(",");for(layerObj={},i=0;i<a.length;i++){var s=a[i].split("|");if(""!=s[0])for(s[0]=s[0].replace(/~/g," "),3==s.length&&s.push(!0),-1==s[2]?layerObj[s[0]]={opacity:s[1],visLayers:[],visible:!0}:layerObj[s[0]]={opacity:s[1],visLayers:s[2].split("-"),visible:"1"==s[3]},j=0;j<layerObj[s[0]].visLayers.length;j++)layerObj[s[0]].visLayers[j]=0|layerObj[s[0]].visLayers[j]}}try{S.getElementsByTagName("hideGroupSublayers")[0]&&S.getElementsByTagName("hideGroupSublayers")[0].firstChild&&(hideGroupSublayers=S.getElementsByTagName("hideGroupSublayers")[0].firstChild.nodeValue.split(","))}catch(e){alert("Warning: Missing hideGroupSublayers tag in "+app+"/config.xml file. "+e.message,"Data Error")}try{S.getElementsByTagName("radiolayers")[0]&&S.getElementsByTagName("radiolayers")[0].firstChild&&(radioLayers=S.getElementsByTagName("radiolayers")[0].firstChild.nodeValue.split(","))}catch(e){alert("Warning: Missing radiolayers tag in "+app+"/config.xml file. "+e.message,"Data Error")}var o=S.getElementsByTagName("operationallayers")[0].getElementsByTagName("layer");for(i=0;i<o.length;i++)D[o[i].getAttribute("label")]=0,e(o[i]);B()}function L(e){const t=e.item;if(0==t.children.length&&t.parent||null===t.parent){const e=new v({min:0,max:1,precision:2,values:[t.layer.opacity],visibleElements:{labels:!0,rangeLabels:!0}});t.panel={content:e,className:"esri-icon-sliders-horizontal",title:"Change layer opacity"},e.on("thumb-drag",e=>{const{value:r}=e;t.layer.opacity=r})}}function B(){require(["dojo/dom","dijit/registry"],function(e,t){for(var r="",a=0;a<S.getElementsByTagName("widget").length;a++){var i="open"==S.getElementsByTagName("widget")[a].getAttribute("preload"),n=S.getElementsByTagName("widget")[a].getAttribute("label"),l=(S.getElementsByTagName("widget")[a].getAttribute("height"),S.getElementsByTagName("widget")[a].getAttribute("video")),s=S.getElementsByTagName("widget")[a].getAttribute("icon");if(null!=n)if(r+=n,"Map Layers & Legend"==n){var o=new x({title:"<img id='tocIcon' role='presentation' alt='map layers icon' src='assets/images/i_layers.png'/> Map Layers",open:i,content:"<div id='tocContent' style='position:relative'><img id='tocHelpBtn' role='button' alt='map layers help' class='help_icon help_icon_dialog' src='assets/images/i_help.png'><div id='listContent'></div></div>"});o.startup(),document.getElementById("tocPane").appendChild(o.domNode),document.getElementById("tocHelpBtn").addEventListener("click",function(){show("tocHelpDialog")});var d=new m({view:view,listItemCreatedFunction:L,container:document.getElementById("listContent")});d.when(()=>{for(var e=document.getElementsByClassName("esri-layer-list__item--has-children"),t=0;t<e.length;t++){var r=e[t].children[0].children[1].children[1].innerHTML;if(hideGroupSublayers.includes(r))e[t].children[0].children[0].style.visibility="hidden",e[t].children[1].style.display="none";else if("Status"===r){for(var a=0;a<map.layers.length;a++)if("Motor Vehicle Use Map"===map.layers.items[a].title){for(var i=0;i<map.layers.items[a].sublayers.length;i++)if("Status"===map.layers.items[a].sublayers.items[i].title){map.layers.items[a].sublayers.items[i].visible=!1;break}break}e[t].children[0].children[1].children[0].children[0].className="esri-icon-non-visible"}}}),d.on("trigger-action",e=>{const t=e.item.layer,r=e.action.id;"full-extent"===r?view.goTo(visibleLayer.fullExtent).catch(e=>{"AbortError"!=e.name&&console.error(e)}):"information"===r?window.open(t.url):"increase-opacity"===r?t.opacity<2&&(t.opacity+=.25):"decrease-opacity"===r&&t.opacity>0&&(t.opacity-=.25)}),null==l&&alert("Warning: Missing help video in "+app+"/config.xml file for widget Map Layers & Legend.","Data Error"),e.byId("tocHelp").href=l,s&&(document.getElementById("tocIcon").src=s),e.byId("tocPane").style.display="block",e.byId("tocPane").style.visibility="visible"}else if(n.indexOf("Resource Report")>0){var y=new x({title:"<img id='reportIcon' role='presentation' alt='resrouce report icon' src='assets/images/i_table.png'/> "+n,open:i,content:document.getElementById("reportContent")});y.startup(),document.getElementById("reportDiv").appendChild(y.domNode),document.getElementById("reportHelpBtn").addEventListener("click",function(){show("reportHelpDialog")}),null==l&&alert("Warning: Missing help video in "+app+"/config.xml file for widget "+n+".","Data Error"),e.byId("reportHelp").href=l,s&&(document.getElementById("reportIcon").src=s),e.byId("reportDiv").style.display="block",e.byId("reportDiv").style.visibility="visible"}else if("Feature Search"==n){var c=new x({title:"<img id='searchIcon' role='presentation' alt='feature search icon' src='assets/images/i_search.png'/> "+n,open:i,content:document.getElementById("searchContent")});c.startup(),document.getElementById("searchDiv").appendChild(c.domNode),document.getElementById("searchHelpBtn").addEventListener("click",function(){show("featureSearchHelpDialog")}),null==l&&alert("Warning: Missing help video in "+app+"/config.xml file for widget Feature Search.","Data Error"),e.byId("searchHelp").href=l,s&&(document.getElementById("searchIcon").src=s),i&&(openedFeatureSearch=!0),e.byId("searchDiv").style.display="block",e.byId("searchDiv").style.visibility="visible"}else{if("Address"==n)continue;if("Draw, Label, & Measure"==n){var u=new x({title:"<img id='drawIcon' role='presentation' alt='feature search icon' src='assets/images/i_measure.png'/> "+n,open:i,content:document.getElementById("drawContent")});u.startup(),document.getElementById("drawDiv").appendChild(u.domNode),document.getElementById("drawHelpBtn").addEventListener("click",function(){show("drawHelpDialog")}),null==l&&alert("Warning: Missing help video in "+app+"/config.xml file for widget Draw, Label, & Measure.","Data Error"),e.byId("drawHelp").href=l,s&&(document.getElementById("drawIcon").src=s),e.byId("drawDiv").style.display="block",e.byId("drawDiv").style.visibility="visible"}else if("Bookmark"==n){var g=new x({title:"<img id='bookmarkIcon' role='presentation' alt='bookmark icon' src='assets/images/i_bookmark.png'/> "+n,open:i,content:document.getElementById("bookmarkContent")});u.startup(),document.getElementById("bookmarkDiv").appendChild(g.domNode),document.getElementById("bookmarkHelpBtn").addEventListener("click",function(){show("bookmarkHelpDialog")}),null==l&&alert("Warning: Missing help video in "+app+"/config.xml file for widget Bookmark.","Data Error"),e.byId("bookmarkHelp").href=l,s&&(document.getElementById("bookmarkIcon").src=s),e.byId("bookmarkDiv").style.display="block",e.byId("bookmarkDiv").style.visibility="visible"}else if("Settings"==n){var p=!0;screen.width<768&&(p=!1);var b=new x({title:"<img id='settingsIcon' alt='settings icon' src='assets/images/i_resources.png'/> "+n,open:!1,content:document.getElementById("settingsContent")});b.startup(),document.getElementById("settingsDiv").appendChild(b.domNode),document.getElementById("settingsHelpBtn").addEventListener("click",function(){show("settingsHelpDialog")}),document.getElementById("toolsMenuChkBox").checked=p,null==l&&alert("Warning: Missing help video in "+app+"/config.xml file for widget Settings.","Data Error"),e.byId("settingsHelp").href=l,s&&(document.getElementById("settingsIcon").src=s),e.byId("settingsDiv").style.display="block",e.byId("settingsDiv").style.visibility="visible"}else"Find a Place"==n||("Print"==n?s&&(document.getElementById("printIcon").src=s):"Identify"==n||("GetExtent"==n?s&&(document.getElementById("extentIcon").src=s):"MapLink"==n?s&&(document.getElementById("linkIcon").src=s):alert("Error in "+app+"/config.xml widget. Label: "+n+" was not found.  \n\nAvailable options include:\n\tMap Layers & Legend\n\t<something> Resource Report \n\tFeature Search\n\tAddress\n\tDraw, Label, & Measure\n\tBookmark\n\tFind a Place\n\tPrint\n\tSettings\n\tIdentify\n Edit javascript/readConfig.js to change this.","Data Error")))}}-1==r.indexOf("Map Layers & Legend")?e.byId("tocPane").style.display="none":-1==r.indexOf("Resource Report")?e.byId("reportDiv").style.display="none":-1==r.indexOf("Feature Search")?e.byId("searchDiv").style.display="none":-1==r.indexOf("Address")?e.byId("addressDiv").style.display="none":-1==r.indexOf("Draw, Label, & Measure")?e.byId("drawDiv").style.display="none":-1==r.indexOf("Bookmark")?e.byId("bookmarkDiv").style.display="none":-1==r.indexOf("Settings")&&(e.byId("settingsDiv").style.display="none");for(var f='<span class="link"><a href="'+app+'/help.html" target="help"><img src="assets/images/i_help.png"/>Help</a></span>',v=S.getElementsByTagName("links")[0].getElementsByTagName("link"),h="",w=0;w<v.length;w++)"Go Mobile"!=v[w].getAttribute("label")&&("Buy License!"==v[w].getAttribute("label")?(h=v[w].getAttribute("url").replace("%3F","?").replace("%26","&"),f+='<span class="link"><a id="licenseLink"><img src="'+v[w].getAttribute("icon")+'"/>'+v[w].getAttribute("label")+"</a></span>"):f+='<span class="link"><a href="'+v[w].getAttribute("url").replace("%3F","?").replace("%26","&")+'" target="_new"><img src="'+v[w].getAttribute("icon")+'"/>'+v[w].getAttribute("label")+"</a></span>");e.byId("links").innerHTML=f,document.getElementById("licenseLink")&&"function"==typeof ga&&document.getElementById("licenseLink").addEventListener("click",function(){window.open(h,"_new"),ga("send","event","buy_license","click","Buy License","1")})})}function T(){const e=new y({basemap:"streets-vector"}),t=document.getElementById("overviewDiv");P=new c({container:"overviewDiv",map:e,extent:fullExtent,constraints:{rotationEnabled:!1}}),P.when(()=>{A()});const a=new p({view:view,content:t,id:"overviewBtn",expandTooltip:"Expand Overview Map",expandIconClass:"esri-icon-overview-arrow-bottom-left",collapseIconClass:"esri-collapse__icon esri-expand__icon--expanded esri-icon-collapse",label:"Show Overview"});view.ui.add(a,"top-right"),R=r.debounce(()=>{view.stationary&&P.goTo({center:view.center,scale:2*view.scale*Math.max(view.width/P.width,view.height/P.height)})})}function A(){var e,t,r,i;let n,l;_=new d({geometry:null,symbol:{type:"simple-fill",color:[0,0,0,.5],outline:null}}),P.graphics.add(_),P.popup.dockEnabled=!0,P.popup.actions=[],P.ui.components=[],P.on("mouse-wheel",function(e){"hidden"!=overviewDiv.style.visibility&&e.stopPropagation()}),P.on("double-click",function(e){"hidden"!=overviewDiv.style.visibility&&e.stopPropagation()}),P.on("double-click",["Control"],function(e){"hidden"!=overviewDiv.style.visibility&&e.stopPropagation()}),P.on("drag",a=>{if("hidden"!=overviewDiv.style.visibility)if("start"===a.action&&P.hitTest(a).then(t=>{t.results[0].graphic&&t.results[0].graphic.geometry&&"extent"===t.results[0].graphic.geometry.type&&(a.stopPropagation(),W=!0,console.log("start dragging"),l=t.results[0].graphic,e=P.toMap({x:a.x,y:a.y}))}),"update"===a.action){if(l){a.stopPropagation(),console.log("update dragging"),n?P.graphics.remove(n):P.graphics.remove(l),n=l.clone(),t=P.toMap({x:a.x,y:a.y}),r=t.x-e.x,i=t.y-e.y,e=t;const s=_.geometry;s.xmin+=r,s.xmax+=r,s.ymin+=i,s.ymax+=i,n.geometry=s,P.graphics.add(n)}}else"end"===a.action&&l&&(a.stopPropagation(),console.log("end dragging"),n&&P.graphics.remove(n),l&&P.graphics.remove(l),_=l.clone(),_.geometry=n?n.geometry.clone():l.geometry.clone(),P.graphics.add(_),l=null,n=null,view.center=_.geometry.extent.center,W=!1)}),P.on("drag",["Shift"],function(e){console.log("shift-drag"),"hidden"!=overviewDiv.style.visibility&&e.stopPropagation()}),P.on("drag",["Shift","Control"],function(e){"hidden"!=overviewDiv.style.visibility&&e.stopPropagation()}),P.on("key-down",e=>{if("hidden"==overviewDiv.style.visibility)return;const t=["+","-","Shift","_","=","ArrowUp","ArrowDown","ArrowRight","ArrowLeft"],r=e.key;-1!==t.indexOf(r)&&e.stopPropagation()}),a.watch(()=>view.extent,e=>{W||(R().then(()=>{_.geometry=e}),P.scale=2*view.scale*Math.max(view.width/P.width,view.height/P.height),P.center=view.center)},{initial:!0})}function C(){require(["dojo/dom","dijit/registry","dojo/sniff","dojo/on"],function(e,t,r,i){try{if(mapBasemap="streets-vector",queryObj.layer&&""!=queryObj.layer){var n=queryObj.layer.substring(0,queryObj.layer.indexOf("|")).split(",");0==n[0]?mapBasemap="streets-vector":1==n[0]?mapBasemap="hybrid":2==n[0]?mapBasemap="topo-vector":mapBasemap=n[0],n=null}var l=[{level:6,resolution:2445.98490512499,scale:9244648.868618},{level:7,resolution:1222.992452562495,scale:4622324.434309},{level:8,resolution:611.4962262813797,scale:2311162.217155},{level:9,resolution:305.74811314055756,scale:1155581.108577},{level:10,resolution:152.87405657041106,scale:577790.554289},{level:11,resolution:76.43702828507324,scale:288895.277144},{level:12,resolution:38.21851414253662,scale:144447.638572},{level:13,resolution:19.10925707126831,scale:72223.819286},{level:14,resolution:9.554628535634155,scale:36111.909643},{level:15,resolution:4.77731426794937,scale:18055.954822},{level:16,resolution:2.388657133974685,scale:9027.977411},{level:17,resolution:1.1943285668550503,scale:4513.988705},{level:18,resolution:.5971642835598172,scale:2256.994353},{level:19,resolution:.29858214164761665,scale:1128.497176}];map=new y({basemap:mapBasemap,lods:l}),view=new c({container:"mapDiv",extent:fullExtent,map:map,constraints:{maxScale:9244649,minScale:1128}})}catch(e){alert("Error creating map in readConfig.js addMap. "+e.message,"Code Error",e)}view.when(()=>{view.on("pointer-move",e=>{showCoordinates(e)}),view.on("click",e=>{console.log("Identify")}),a.watch(()=>view.zoom,()=>{showMapScale(parseInt(view.scale))},{initial:!0}),view.on("update-start",showLoading),view.on("update-end",hideLoading),showMapScale(view.scale),k();let e=new b({view:view});const t=new p({view:view,content:e,expandIconClass:"esri-icon-legend"});view.ui.add(t,"top-right");let r=new f({view:view,unit:"dual"});view.ui.add(r,{position:"bottom-left"});const i=new g({view:view});view.ui.add(i,"top-left")})})}var S,N,M,D={};if(screen.width<768){var G=document.getElementById("title").innerHTML;G.indexOf("Colorado")>-1&&(G="CO "+G.substring(G.indexOf(" ")+1),document.getElementById("title").innerHTML=G)}var _,P,R,W=!1;try{var U=getCookie("xycoords");document.getElementById("xycoords_combo").value=""==U?"dms":U;var F,V=document.location.search.replace(/\%0D/g,"newline");if(queryObj=t.queryToObject(V.substring("?"===V[0]?1:0)),queryObj.point&&(queryObj.point=queryObj.point.replace(/~/g," "),F=/([^a-zA-Z0-9 °\-\'\"\|;,\.!_\*()\\])/g,F.test(queryObj.point)&&alert("Illegal characters were removed from way point labels.","Warning"),F=/([^a-zA-Z0-9 °\-\'\"\|;,\.!_\*()])/g,queryObj.point=queryObj.point.replace(F,""),queryObj.point=queryObj.point.replace(/newline/g,"\n")),queryObj.line&&(F=/([^a-zA-Z0-9 \-\'\|;,\.!_\*()\\])/g,F.test(queryObj.line)&&alert("Illegal characters were removed from the line labels.","Warning"),F=/([^a-zA-Z0-9 \-\'\|;,\.!_\*()])/g,queryObj.line=queryObj.line.replace(F,"")),queryObj.poly&&(F=/([^a-zA-Z0-9 \-\'\|;,\.!_\*()\\])/g,F.test(queryObj.poly)&&alert("Illegal characters were removed from the shape (polygon) labels.","Warning"),F=/([^a-zA-Z0-9 \-\'\|;,\.!_\*()])/g,queryObj.poly=queryObj.poly.replace(F,"")),queryObj.rect&&(F=/([^a-zA-Z0-9 \-\'\|;,\.!_\*()\\])/g,F.test(queryObj.rect)&&alert("Illegal characters were removed from the rectangle labels.","Warning"),F=/([^a-zA-Z0-9 \-\'\|;,\.!_\*()])/g,queryObj.rect=queryObj.rect.replace(F,"")),queryObj.text&&(F=/([^a-zA-Z0-9 \-\'\|;,\.!_\*()\\])/g,F.test(queryObj.text)&&alert("Illegal characters were removed from the point labels.","Warning"),F=/([^a-zA-Z0-9 \-\'\|;,\.!_\*()])/g,queryObj.text=queryObj.text.replace(F,"")),queryObj.layer&&(queryObj.layer=queryObj.layer.replace(/~/g," "),F=/([^a-zA-Z0-9 \-\|,\._()])/g,F.test(queryObj.layer)&&alert("Illegal characters were found on the URL. Layers may not load properly.","Warning"),queryObj.layer=queryObj.layer.replace(F,"")),queryObj.keyword&&(F=/([^a-zA-Z0-9 \-\._()])/g,F.test(queryObj.keyword)&&alert("Illegal characters were found on the URL. Location may not load properly.","Warning"),queryObj.keyword=queryObj.keyword.replace(F,"")),queryObj.value){F=/([^a-zA-Z0-9 \-\',\.!_\*()\\#/&])/g,F.test(queryObj.value)&&alert("Illegal characters were found on the URL. Location may not load properly.","Warning"),F=/([^a-zA-Z0-9 \-\',\.!_\*()#/&])/g,queryObj.value=queryObj.value.replace(F,"");var H=/'/g;queryObj.value=queryObj.value.replace(H,"''")}queryObj.label&&(F=/([^a-zA-Z0-9 \-\',\.!_\*()#&/\\])/g,F.test(queryObj.label)&&alert("Illegal characters were found on the URL. Point labels may not load properly.","Warning"),F=/([^a-zA-Z0-9 \-\',\.!_\*()#&/])/g,queryObj.label=queryObj.label.replace(F,"")),queryObj.map&&(F=/([^a-zA-Z0-9 \-,\._():\/])/g,F.test(queryObj.map)&&alert("Illegal characters were found on the URL. Map may not load properly.","Warning"),queryObj.map=queryObj.map.replace(F,"")),queryObj.field&&(F=/([^a-zA-Z0-9 \-_])/g,F.test(queryObj.field)&&alert("Illegal characters were found on the URL. Map may not load properly.","Warning"),queryObj.field=queryObj.field.replace(F,"")),queryObj.prj&&isNaN(queryObj.prj)&&(queryObj.prj=102100,alert("Problem reading map projection from the URL, defaulting to WGS84.","Warning")),queryObj.extent&&(F=/([^0-9 \-,\.])/g,F.test(queryObj.extent)&&alert("Illegal characters were found on the URL. Map extent may not load properly.","Warning"),queryObj.extent=queryObj.extent.replace(F,"")),queryObj.place&&(F=/([^a-zA-Z0-9 \-\',\.!_*():#&/\\])/g,F.test(queryObj.place)&&alert("Illegal characters were found on the URL. Location may not load properly.","Warning"),F=/([^a-zA-Z0-9 \-\',\.!_*():#&/])/g,queryObj.place=queryObj.place.replace(F,"")),document.getElementById("mapDescFile").href=app+"/definitions.html";var z=createXMLhttpRequest(),Z=app+"/config.xml?v="+ndisVer;z.onreadystatechange=function(){if(4==z.readyState&&200===z.status){S=createXMLdoc(z);try{geometryService=S.getElementsByTagName("geometryservice")[0].getAttribute("url")}catch(e){alert("Missing tag: geometryservice in "+app+'/config.xml.\n\nTag should look like: &lt;geometryservice url="https://ndismaps.nrel.colostate.edu/ArcGIS/rest/services/Utilities/Geometry/GeometryServer"/&gt;\n\nWill use that url for now.',"Data Error"),geometryService="https://ndismaps.nrel.colostate.edu/ArcGIS/rest/services/Utilities/Geometry/GeometryServer"}try{printServiceUrl=S.getElementsByTagName("printservice")[0].firstChild.nodeValue}catch(e){alert("Missing tag: printservice in "+app+"/config.xml.\n\nTag should look like: &lt;printservice&gt;https://ndismaps.nrel.colostate.edu/arcgis/rest/services/Utilities/PrintingTools/GPServer/Export%20Web%20Map%20Task&lt;/printservice&gt;\n\nWill use that url for now.","Data Error"),printServiceUrl="https://ndismaps.nrel.colostate.edu/arcgis/rest/services/Utilities/PrintingTools/GPServer/Export%20Web%20Map%20Task"}try{printGeoServiceUrl=S.getElementsByTagName("printservicegeo")[0].firstChild.nodeValue}catch(e){alert("Missing tag: printservicegeo in "+app+"/config.xml.\n\nTag should look like: &lt;printservicegeo&gt;https://ndismaps.nrel.colostate.edu/arcgis/rest/services/PrintTemplate/georefPrinting/GPServer/georefPrinting&lt;/printservice&gt;\n\nWill use that url for now.","Data Error"),printGeoServiceUrl="https://ndismaps.nrel.colostate.edu/arcgis/rest/services/PrintTemplate/georefPrinting/GPServer/georefPrinting"}var t;try{t=S.getElementsByTagName("title")[0].firstChild.nodeValue}catch(e){alert("Warning: Missing title tag in "+app+"/config.xml file. "+e.message,"Data Error")}try{e.byId("title").innerHTML=t,document.title=t,e.byId("subtitle").innerHTML=S.getElementsByTagName("subtitle")[0].firstChild.nodeValue,e.byId("logo").src=S.getElementsByTagName("logo")[0].firstChild.nodeValue,e.byId("logourl").href=S.getElementsByTagName("logourl")[0].firstChild.nodeValue}catch(e){alert("Warning: Missing title, subtitle, logo, or logurl tag in "+app+"/config.xml file. "+e.message,"Data Error")}S.getElementsByTagName("noDisclaimer")&&S.getElementsByTagName("noDisclaimer")[0]&&"true"==S.getElementsByTagName("noDisclaimer")[0].firstChild.nodeValue||1!=getCookie("noDisclaimer")&&loadDisclaimer(t);try{myFindService=S.getElementsByTagName("findplaceservice")[0].getAttribute("url")}catch(e){alert("Missing tag: findplaceservice in "+app+'/config.xml.\n\nTag should look like: &lt;findplaceservice url="https://ndismaps.nrel.colostate.edu/ArcGIS/rest/services/GNIS_Loc/GeocodeServer"/&gt;\n\nWill use that url for now.',"Data Error"),myFindService="https://ndismaps.nrel.colostate.edu/ArcGIS/rest/services/GNIS_Loc/GeocodeServer"}try{N=S.getElementsByTagName("map")[0].getAttribute("initialextent").split(" "),wkid=parseInt(S.getElementsByTagName("map")[0].getAttribute("wkid").trim()),fullExtent=new u({xmin:parseFloat(N[0]),ymin:parseFloat(N[1]),xmax:parseFloat(N[2]),ymax:parseFloat(N[3]),spatialReference:{wkid:wkid}})}catch(e){alert("Warning: Missing tag attributes initalextent or wkid for the map tag in "+app+"/config.xml file. "+e.message,"Data Error")}if(C(),T(),hideLoading(),queryObj.extent&&""!=queryObj.extent){var r,a=[];a="[object Array]"===Object.prototype.toString.call(queryObj.extent)?queryObj.extent[0].split(","):queryObj.extent.split(","),r=queryObj.prj&&""!=queryObj.prj?queryObj.prj:a[0]<0&&a[0]>-200?4326:26913,N=new u({xmin:parseFloat(a[0]),ymin:parseFloat(a[1]),xmax:parseFloat(a[2]),ymax:parseFloat(a[3]),spatialReference:{wkid:parseInt(r)}});var i=new h;i.geometries=[N],i.outSR=new o(wkid),s.project(geometryService,i,function(e){initExtent=e[0],view.extent=initExtent},function(e){alert("There was a problem converting the extent read from the URL to Web Mercator projection. extent="+a[0],", "+a[1]+", "+a[2]+", "+a[3]+"  prj="+r+"  "+e.message,"URL Extent Error",e)})}else initExtent=new u({xmin:parseFloat(N[0]),ymin:parseFloat(N[1]),xmax:parseFloat(N[2]),ymax:parseFloat(N[3]),spatialReference:{wkid:wkid}}),view.extent=initExtent;if(queryObj.place&&""!=queryObj.place){var n=queryObj.place.replace("%20"," ");queryObj.prj&&""!=queryObj.prj&&(settings={XYProjection:queryObj.prj}),gotoLocation(n,!0)}queryObj.keyword&&""!=queryObj.keyword&&(queryObj.value&&""!=queryObj.value?require(["esri/request","esri/tasks/QueryTask","esri/tasks/query"],function(e,t,r){var a=app+"/url.xml?v="+ndisVer,i=createXMLhttpRequest();i.onreadystatechange=function(){if(4==i.readyState&&200===i.status){for(var e=createXMLdoc(i),a=e.getElementsByTagName("layer"),n=0;n<a.length&&(a[n].getElementsByTagName("keyword")[0]&&a[n].getElementsByTagName("keyword")[0].firstChild||alert("Missing tag keyword or blank, in "+app+"/url.xml file.","Data Error"),queryObj.keyword!=a[n].getElementsByTagName("keyword")[0].firstChild.nodeValue);n++);if(n==a.length)alert("Keyword ["+queryObj.keyword+"] is not defined in "+app+"/url.xml file.","Data Error");else if(a[n].getElementsByTagName("url")[0]&&a[n].getElementsByTagName("url")[0].firstChild||alert("Missing tag url or blank, in "+app+"/url.xml file for keyword: "+queryObj.keyword+".","Data Error"),a[n].getElementsByTagName("expression")[0]&&a[n].getElementsByTagName("expression")[0].firstChild){var l=a[n].getElementsByTagName("expression")[0].firstChild.nodeValue.replace("[value]",queryObj.value),s=new t(a[n].getElementsByTagName("url")[0].firstChild.nodeValue),o=new r;o.where=l,o.returnGeometry=!0,s.execute(o,function(e){0==e.features.length?gotoLocation(queryObj.value,!0):require(["esri/geometry/Point","esri/graphicsUtils","esri/layers/GraphicsLayer","esri/graphic","esri/symbols/PictureMarkerSymbol"],function(t,r,i,l,s){var o,d
;if("esriGeometryPoint"==e.geometryType){var y=8;if(a[n].getElementsByTagName("mapscale")[0]&&a[n].getElementsByTagName("mapscale")[0].firstChild&&(y=parseInt(a[n].getElementsByTagName("mapscale")[0].firstChild.nodeValue)),y>11&&(y=8),o=new t(e.features[0].geometry.x,e.features[0].geometry.y,e.spatialReference),map.centerAndZoom(o,y),queryObj.label&&""!=queryObj.label){d=new i,d.id="searchgraphics"+searchGraphicsCounter,searchGraphicsCount.push(d.id),searchGraphicsCounter++,addLabel(new l(o),queryObj.label,d,"11pt");var c=new s("assets/images/yellowdot.png",30,30);d.add(new l(o,c)),document.getElementById("findClear").style.opacity=1,document.getElementById("findClear").style.filter="alpha(opacity=100)"}}else if("esriGeometryPolygon"==e.geometryType){var g=!1;if(a[n].getElementsByTagName("union")[0]&&a[n].getElementsByTagName("union")[0].firstChild&&"true"===a[n].getElementsByTagName("union")[0].firstChild.nodeValue.toLowerCase()&&(g=!0),g){for(var p=new u(e.features[0].geometry.getExtent()),m=0;m<e.features.length;m++){var b=e.features[m].geometry.getExtent();p=p.union(b)}map.setExtent(p),o=p.getCenter()}else o=e.features[0].geometry.getCentroid(),map.setExtent(e.features[0].geometry.getExtent(),!0);queryObj.label&&""!=queryObj.label&&(d=new i,d.id="searchgraphics"+searchGraphicsCounter,searchGraphicsCount.push(d.id),searchGraphicsCounter++,addLabel(new l(o),queryObj.label,d,"11pt"),document.getElementById("findClear").style.opacity=1,document.getElementById("findClear").style.filter="alpha(opacity=100)")}else map.setExtent(e.features[0].geometry.getExtent(),!0)})},function(e){e.responseText?(alert("Error: QueryTask failed for keyword="+queryObj.keyword+" value="+queryObj.value+" "+e.message+e.responseText,"URL Keyword/Value Error",e),document.execCommand("Stop")):(alert("Error: QueryTask failed for keyword="+queryObj.keyword+" value="+queryObj.value+" "+e.message,"URL Keyword/Value Error",e),document.execCommand("Stop"))})}else alert("Missing tag expression, in "+app+"/url.xml file for keyword: "+queryObj.keyword,"Data Error")}else 404===i.status?alert("Missing url.xml file in "+app+" directory.","Data Error"):4===i.readyState&&500===i.status&&alert("Error: had trouble reading "+app+"/url.xml file in readConfig.js.","Data Error")},i.open("GET",a,!0),i.send(null)}):alert("When &keyword is used on the URL, there must be a &value also.","URL Keyword/Value Error")),queryObj.map&&""!=queryObj.map&&(queryObj.value&&""!=queryObj.value&&queryObj.field&&""!=queryObj.field?require(["esri/request","esri/tasks/QueryTask","esri/tasks/query"],function(e,t,r){var a=new t(queryObj.map),i=new r;Number(queryObj.value)?i.where=queryObj.field+"="+queryObj.value:i.where="UPPER("+queryObj.field+") LIKE UPPER('"+queryObj.value+"')",i.returnGeometry=!0,a.execute(i,function(e){require(["esri/geometry/Point","esri/graphicsUtils"],function(t,r){0==e.features.length?alert("Cannot zoom to "+queryObj.value+". The feature was not found in "+queryObj.map+" for field "+queryObj.field,"URL Map/Value Error"):"esriGeometryPoint"==e.geometryType?map.centerAndZoom(new t(e.features[0].geometry.x,e.features[0].geometry.y,e.spatialReference),8):map.setExtent(e.features[0].geometry.getExtent(),!0)})},function(e){e.responseText?alert("Error: QueryTask failed for map="+queryObj.map+" "+e.message+e.responseText,"URL Map/Value Error",e):alert("Error: QueryTask failed for map="+queryObj.map+" "+e.message,"URL Map/Value Error",e)})}):alert("When &map is used on the URL, there must also be an &field and &value.","URL Map/Value Error"))}else 404===z.status?(alert("Error: Missing config.xml file in "+app+" directory.","Data Error"),hideLoading()):4===z.readyState&&500===z.status&&(alert("Make sure your application name is correct on the URL. app="+app,"Warning"),hideLoading())},z.open("GET",Z,!0),z.send(null)}catch(e){alert("Error in javascript/readConfig.js. "+e.message,"Code Error",e)}})}var locator,layerObj,addressGraphicsCount=[],addressGraphicsCounter=0;