function lookupAddress(){require(["dojo/dom"],function(e){"function"==typeof ga&&ga("send","event","address","click","Address","1");var r=e.byId("streetTxt").value,t=/([^a-zA-Z0-9 \-\',\.()])/g;if(t.test(r))return r=r.replace(t,""),e.byId("streetTxt").value=r,void alert("Illegal characters were removed from the address.","Warning");var a=e.byId("cityTxt").value;if(t=/([^a-zA-Z0-9 \-\'()])/g,t.test(a))return a=a.replace(t,""),e.byId("cityTxt").value=a,void alert("Illegal characters were removed from the city.","Warning");var i=e.byId("zipTxt").value;if(t=/([^0-9 \-])/g,t.test(i))return i=i.replace(t,""),e.byId("zipTxt").value=i,void alert("Illegal characters were removed from the zip code.","Warning");""!==r&&""!==a?require(["esri/geometry/Extent"],function(t){showLoading(),e.byId("addressLoading").style.display="block";var l={Address:r,City:a,Region:"CO",Postal:i};locator.outSpatialReference=map.spatialReference;var s=new t({xmin:-1235e4,ymin:425e4,xmax:-1115e4,ymax:525e4,spatialReference:{wkid:wkid}}),n={address:l,searchExtent:s};locator.addressToLocations(n,onAddressResults,onAddressFault)}):(hideLoading(),e.byId("addressLoading").style.display="none",alert("Street and City are required fields.","Warning"))})}function onAddressResults(e){try{require(["dojo/dom","esri/symbols/SimpleMarkerSymbol","esri/symbols/PictureMarkerSymbol","esri/graphic","esri/symbols/Font","esri/symbols/TextSymbol","dojo/_base/Color"],function(r,t,a,i,l,s,n){hideLoading(),r.byId("addressLoading").style.display="none";var o,d=new a("assets/images/i_address.png",30,30);return e.every(function(e){var r;e.score>40&&require(["esri/layers/GraphicsLayer","dojo/_base/Color"],function(t,a){o=e.location,r=new t,r.id="addressgraphics"+addressGraphicsCounter,addressGraphicsCount.push(r.id),addressGraphicsCounter++,r.add(new i(o,d));var n=e.address,y=new l("10pt",l.STYLE_NORMAL,l.VARIANT_NORMAL,l.WEIGHT_BOLD,"Helvetica"),u=new a([255,255,153,255]),g=new s(n,y,new a("#000000"));g.setOffset(0,-23);var c=new esri.symbol.TextSymbol(n,y,u);c.setOffset(1,-25);var p=new esri.symbol.TextSymbol(n,y,u);p.setOffset(0,-24);var m=new esri.symbol.TextSymbol(n,y,u);m.setOffset(0,-22);var b=new esri.symbol.TextSymbol(n,y,u);b.setOffset(-1,-21);var f=new esri.symbol.TextSymbol(n,y,u);f.setOffset(2,-23);var v=new esri.symbol.TextSymbol(n,y,u);return v.setOffset(-2,-23),r.add(new esri.Graphic(o,c)),r.add(new esri.Graphic(o,p)),r.add(new esri.Graphic(o,m)),r.add(new esri.Graphic(o,b)),r.add(new esri.Graphic(o,f)),r.add(new esri.Graphic(o,v)),r.add(new i(o,g)),map.addLayer(r),!1})}),void 0!==o?(map.centerAndZoom(o,6),!0):(alert("Address was not found.","Note"),!1)})}catch(e){return alert("Error looking up address: "+e.message,"Code Error",e),!1}}function onAddressFault(e){require(["dojo/dom"],function(r){hideLoading(),r.byId("addressLoading").style.display="none",alert("Error occurred searching for address. Address service may be down. Service name is: "+locator.url+". "+e.message,"Code Error",e)})}function clearAddress(){0!=addressGraphicsCount.length&&map.getLayer(addressGraphicsCount.pop()).clear()}function readConfig(){require(["dojo/dom","dojo/io-query","esri/layers/MapImageLayer","esri/layers/FeatureLayer","esri/rest/geometryService","esri/geometry/SpatialReference","esri/Map","esri/views/MapView","esri/geometry/Extent","esri/rest/support/ProjectParameters","esri/symbols/SimpleFillSymbol","dijit/form/CheckBox","esri/symbols/SimpleLineSymbol","dojo/sniff"],function(e,r,t,a,l,s,n,o,d,y,u,g,c,p){function m(){function e(e){var i,s=e.getAttribute("label");if(w[s]++,queryObj.layer&&""!=queryObj.layer)if(e.getAttribute("url").toLowerCase().indexOf("mapserver")>-1)i=layerObj[s]?new t(e.getAttribute("url"),{opacity:layerObj[s].opacity,id:s,visible:layerObj[s].visible,visibleLayers:layerObj[s].visLayers}):new t(e.getAttribute("url"),{opacity:Number(e.getAttribute("alpha")),id:s,visible:!1});else{if(!(e.getAttribute("url").toLowerCase().indexOf("featureserver")>-1))return void alert("Unknown operational layer type. It must be of type MapServer or FeatureServer. Or edit readConfig.js line 600 to add new type.");i=layerObj[s]?new a(e.getAttribute("url"),{opacity:Number(e.getAttribute("alpha")),id:s,visible:layerObj[s].visible,visibleLayers:layerObj[s].visLayers}):new a(e.getAttribute("url"),{opacity:Number(e.getAttribute("alpha")),id:s,visible:!1})}else if(e.getAttribute("url").toLowerCase().indexOf("mapserver")>-1)i="false"==e.getAttribute("visible")?new t(e.getAttribute("url"),{opacity:Number(e.getAttribute("alpha")),id:s,visible:!1}):new t(e.getAttribute("url"),{opacity:Number(e.getAttribute("alpha")),id:s,visible:!0});else{if(!(e.getAttribute("url").toLowerCase().indexOf("featureserver")>-1))return void alert("Unknown operational layer type. It must be of type MapServer or FeatureServer. Or edit readConfig.js line 600 to add new type.");i="false"==e.getAttribute("visible")?new a(e.getAttribute("url"),{opacity:Number(e.getAttribute("alpha")),id:s,visible:!1}):new a(e.getAttribute("url"),{opacity:Number(e.getAttribute("alpha")),id:s,visible:!0})}i.on("load",r),i.on("error",l)}function r(e){try{for(var r,t,a=[],i=0;i<v.getElementsByTagName("operationallayers")[0].getElementsByTagName("layer").length;i++)e.layer.id===v.getElementsByTagName("operationallayers")[0].getElementsByTagName("layer")[i].getAttribute("label")&&(t=v.getElementsByTagName("operationallayers")[0].getElementsByTagName("layer")[i]);if(O){r=!1,"false"==t.getAttribute("open")&&(r=!0);var l=t.getAttribute("opensublayer");l&&(a=l.split(",")),l=null}else{r=!0,e.layer.visible&&(r=!1);var s,n=new Array(0,1,2,3,4,5,6,7,8,9),o=[];if(layerObj[e.layer.id]){if(o=e.layer.layerInfos,"Hunter Reference"==e.layer.id){for(s=0;s<layerObj[e.layer.id].visLayers.length;s++)if(o[layerObj[e.layer.id].visLayers[s]].name.substr(o[layerObj[e.layer.id].visLayers[s]].name.length-3,3).indexOf("GMU")>-1){gmu=o[layerObj[e.layer.id].visLayers[s]].name;break}}else if("Game Species"==e.layer.id)for(s=0;s<layerObj[e.layer.id].visLayers.length;s++){if("Bighorn Sheep"===o[layerObj[e.layer.id].visLayers[s]].name){gmu="Bighorn GMU";break}if("Mountain Goat"===o[layerObj[e.layer.id].visLayers[s]].name){gmu="Goat GMU";break}}for(s=0;s<o.length;s++)-1!=layerObj[e.layer.id].visLayers.indexOf(o[s].id)?o[s].defaultVisibility=!0:-1==o[s].parentLayerId||o[s].subLayerIds?o[s].defaultVisibility=!1:o[s].name.substr(o[s].name.length-3,3).indexOf("GMU")>-1||1==o[s].defaultVisibility&&-1===layerObj[e.layer.id].visLayers.indexOf(o[s].parentLayerId)&&(layerObj[e.layer.id].visLayers.push(s),n.indexOf(parseInt(o[o[s].parentLayerId].name.substr(0,1)))>-1&&(layerObj[e.layer.id].visLayers.push(o[s].parentLayerId),o[o[s].parentLayerId].defaultVisibility=!0));e.layer.setVisibleLayers(layerObj[e.layer.id].visLayers.sort(function(e,r){return e-r})),e.layer.refresh()}}legendLayers.push({layer:e.layer,title:e.layer.id,autoToggle:!0,slider:!0,slider_ticks:3,slider_labels:["transparent","50%","opaque"],hideGroupSublayers:hideGroupSublayers,radioLayers:radioLayers,noLegend:!0,openSubLayers:a,collapsed:r}),map.addLayer(e.layer),a=null}catch(e){alert("Error in readConfig.js/layerLoadedHandler "+e.message,"Code Error",e)}}function l(r){for(var t,a=0;a<v.getElementsByTagName("operationallayers")[0].getElementsByTagName("layer").length;a++)if(v.getElementsByTagName("operationallayers")[0].getElementsByTagName("layer")[a].getAttribute("label")===r.target.id){t=v.getElementsByTagName("operationallayers")[0].getElementsByTagName("layer")[a];break}w[r.target.id]<5?setTimeout(function(){e(t)},2e3):5==w[r.target.id]?(r.target.id.indexOf("Motor Vehicle")>-1||r.target.id.indexOf("Wildfire")>-1||r.target.id.indexOf("BLM")>-1?alert("The external map service that provides "+r.target.id+" is experiencing problems.  This issue is out of CPW control. We will continue to try to load it. We apologize for any inconvenience.","External (Non-CPW) Map Service Error"):alert(r.target.id+" service is busy or not responding. We will continue to try to load it.","Data Error"),setTimeout(function(){e(t)},3e4)):setTimeout(function(){e(t)},3e4)}if(O=!0,queryObj.layer&&""!=queryObj.layer){O=!1;var s=queryObj.layer.substring(queryObj.layer.indexOf("|")+1).split(",");for(layerObj={},i=0;i<s.length;i++){var n=s[i].split("|");if(""!=n[0])for(n[0]=n[0].replace(/~/g," "),3==n.length&&n.push(!0),-1==n[2]?layerObj[n[0]]={opacity:n[1],visLayers:[],visible:!0}:layerObj[n[0]]={opacity:n[1],visLayers:n[2].split("-"),visible:"1"==n[3]},j=0;j<layerObj[n[0]].visLayers.length;j++)layerObj[n[0]].visLayers[j]=0|layerObj[n[0]].visLayers[j]}}try{v.getElementsByTagName("hideGroupSublayers")[0]&&v.getElementsByTagName("hideGroupSublayers")[0].firstChild&&(hideGroupSublayers=v.getElementsByTagName("hideGroupSublayers")[0].firstChild.nodeValue.split(","))}catch(e){alert("Warning: Missing hideGroupSublayers tag in "+app+"/config.xml file. "+e.message,"Data Error")}try{v.getElementsByTagName("radiolayers")[0]&&v.getElementsByTagName("radiolayers")[0].firstChild&&(radioLayers=v.getElementsByTagName("radiolayers")[0].firstChild.nodeValue.split(","))}catch(e){alert("Warning: Missing radiolayers tag in "+app+"/config.xml file. "+e.message,"Data Error")}var o=v.getElementsByTagName("operationallayers")[0].getElementsByTagName("layer");for(i=0;i<o.length;i++)w[o[i].getAttribute("label")]=0,e(o[i])}function b(){require(["dojo/dom","dijit/registry"],function(e,r){for(var t="",a=0;a<v.getElementsByTagName("widget").length;a++){var i="open"==v.getElementsByTagName("widget")[a].getAttribute("preload"),l=v.getElementsByTagName("widget")[a].getAttribute("label"),s=v.getElementsByTagName("widget")[a].getAttribute("height"),n=v.getElementsByTagName("widget")[a].getAttribute("video"),o=v.getElementsByTagName("widget")[a].getAttribute("icon");if(null!=l)if(t+=l,"Map Layers & Legend"==l)null==n&&alert("Warning: Missing help video in "+app+"/config.xml file for widget Map Layers & Legend.","Data Error"),e.byId("tocHelp").href=n,o&&(document.getElementById("tocIcon").src=o),i&&r.byId("tocPane").toggle(),e.byId("tocPane").style.display="block",e.byId("tocPane").style.visibility="visible",s&&""!=s&&(document.getElementById("tocContent").style.height=s+"px");else if("HB1298 Report"==l)null==n&&alert("Warning: Missing help video in "+app+"/config.xml file for widget Map Layers & Legend.","Data Error"),e.byId("hb1298Help").href=n,o&&(document.getElementById("hb1298Icon").src=o),document.getElementById("hb1298Pane").style.display="block",i&&(openedHB1298=!0,loadjscssfile("javascript/hb1298.js","js"));else if(l.indexOf("Resource Report")>0)null==n&&alert("Warning: Missing help video in "+app+"/config.xml file for widget "+l+".","Data Error"),e.byId("reportHelp").href=n,o&&(document.getElementById("reportIcon").src=o),e.byId("reportTitle").innerHTML=l,i&&r.byId("reportDiv").toggle(),e.byId("reportDiv").style.display="block",e.byId("reportDiv").style.visibility="visible",reportInit();else if("Feature Search"==l)null==n&&alert("Warning: Missing help video in "+app+"/config.xml file for widget Feature Search.","Data Error"),e.byId("searchHelp").href=n,o&&(document.getElementById("searchIcon").src=o),i&&(r.byId("searchDiv").toggle(),openedFeatureSearch=!0,searchInit()),e.byId("searchDiv").style.display="block",e.byId("searchDiv").style.visibility="visible";else if("Address"==l){try{locator=new Locator(v.getElementsByTagName("addressservice")[0].getAttribute("url"))}catch(e){alert("Missing tag: addressservice in "+app+'/config.xml.\n\nTag should look like: &lt;addressservice url="https://geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer/findAddressCandidates"/&gt;\n\nWill use that url for now.',"Data Error"),locator=new Locator("https://geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer/findAddressCandidates")}null==n&&alert("Warning: Missing help video in "+app+"/config.xml file for widget Address.","Data Error"),o&&(document.getElementById("addressIcon").src=o),e.byId("addressHelp").href=n,i&&r.byId("addressPane").toggle(),e.byId("addressPane").style.display="block",e.byId("addressPane").style.visibility="visible"}else"Draw, Label, & Measure"==l?(null==n&&alert("Warning: Missing help video in "+app+"/config.xml file for widget Draw, Label, & Measure.","Data Error"),e.byId("drawHelp").href=n,o&&(document.getElementById("drawIcon").src=o),i&&r.byId("drawDiv").toggle(),e.byId("drawDiv").style.display="block",e.byId("drawDiv").style.visibility="visible"):"Bookmark"==l?(null==n&&alert("Warning: Missing help video in "+app+"/config.xml file for widget Bookmark.","Data Error"),e.byId("bookmarkHelp").href=n,o&&(document.getElementById("bookmarkIcon").src=o),setBookmarks(),i&&r.byId("bookmarkDiv").toggle(),e.byId("bookmarkDiv").style.display="block",e.byId("bookmarkDiv").style.visibility="visible"):"Settings"==l?(null==n&&alert("Warning: Missing help video in "+app+"/config.xml file for widget Settings.","Data Error"),e.byId("settingsHelp").href=n,o&&(document.getElementById("settingsIcon").src=o),i&&r.byId("settingsDiv").toggle(),e.byId("settingsDiv").style.display="block",e.byId("settingsDiv").style.visibility="visible"):"Find a Place"==l||("Print"==l?o&&(document.getElementById("printIcon").src=o):"Identify"==l||("GetExtent"==l?o&&(document.getElementById("extentIcon").src=o):"MapLink"==l?o&&(document.getElementById("linkIcon").src=o):alert("Error in "+app+"/config.xml widget. Label: "+l+" was not found.  \n\nAvailable options include:\n\tMap Layers & Legend\n\t<something> Resource Report \n\tFeature Search\n\tAddress\n\tDraw, Label, & Measure\n\tBookmark\n\tFind a Place\n\tPrint\n\tSettings\n\tIdentify\n Edit javascript/readConfig.js to change this.","Data Error")))}printInit(),-1==t.indexOf("Map Layers & Legend")?e.byId("tocPane").style.display="none":-1==t.indexOf("Resource Report")?e.byId("reportDiv").style.display="none":-1==t.indexOf("Feature Search")?e.byId("searchDiv").style.display="none":-1==t.indexOf("Address")?e.byId("addressPane").style.display="none":-1==t.indexOf("Draw, Label, & Measure")?e.byId("drawDiv").style.display="none":-1==t.indexOf("Bookmark")?e.byId("bookmarkDiv").style.display="none":-1==t.indexOf("Settings")&&(e.byId("settingsDiv").style.display="none");for(var d='<span class="link"><a href="'+app+'/help.html" target="help"><img src="assets/images/i_help.png"/>Help</a></span>',y=v.getElementsByTagName("links")[0].getElementsByTagName("link"),u="",g=0;g<y.length;g++)"Go Mobile"==y[g].getAttribute("label")?d+='<span class="link"><a href="'+window.location.href.replace("index","indexM")+'" target="_top"><img src="'+y[g].getAttribute("icon")+'"/>'+y[g].getAttribute("label")+"</a></span>":"Buy License!"==y[g].getAttribute("label")?(u=y[g].getAttribute("url").replace("%3F","?").replace("%26","&"),d+='<span class="link"><a id="licenseLink"><img src="'+y[g].getAttribute("icon")+'"/>'+y[g].getAttribute("label")+"</a></span>"):d+='<span class="link"><a href="'+y[g].getAttribute("url").replace("%3F","?").replace("%26","&")+'" target="_new"><img src="'+y[g].getAttribute("icon")+'"/>'+y[g].getAttribute("label")+"</a></span>";e.byId("links").innerHTML=d,document.getElementById("licenseLink")&&"function"==typeof ga&&document.getElementById("licenseLink").addEventListener("click",function(){ga("send","event","buy_license","click","Buy License","1"),window.open(u,"_new")}),m()})}function f(){require(["dojo/dom","dijit/registry","dojo/sniff","dojo/on"],function(e,r,t,a){try{if(mapBasemap="streets-vector",queryObj.layer&&""!=queryObj.layer){var i=queryObj.layer.substring(0,queryObj.layer.indexOf("|")).split(",");0==i[0]?mapBasemap="streets-vector":1==i[0]?mapBasemap="hybrid":2==i[0]?mapBasemap="topo-vector":mapBasemap=i[0],i=null}b()}catch(e){alert("Error in readConfig.js/addMap "+e.message,"Code Error",e)}})}var v,h,O,w={};if(screen.width<768){var E=document.getElementById("title").innerHTML;E.indexOf("Colorado")>-1&&(E="CO "+E.substring(E.indexOf(" ")+1),document.getElementById("title").innerHTML=E)}try{var q=getCookie("xycoords");document.getElementById("xycoords_combo").value=""==q?"dms":q;var x,L=document.location.search.replace(/\%0D/g,"newline");if(queryObj=r.queryToObject(L.substring("?"===L[0]?1:0)),queryObj.point&&(queryObj.point=queryObj.point.replace(/~/g," "),x=/([^a-zA-Z0-9 °\-\'\"\|;,\.!_\*()\\])/g,x.test(queryObj.point)&&alert("Illegal characters were removed from way point labels.","Warning"),x=/([^a-zA-Z0-9 °\-\'\"\|;,\.!_\*()])/g,queryObj.point=queryObj.point.replace(x,""),queryObj.point=queryObj.point.replace(/newline/g,"\n")),queryObj.line&&(x=/([^a-zA-Z0-9 \-\'\|;,\.!_\*()\\])/g,x.test(queryObj.line)&&alert("Illegal characters were removed from the line labels.","Warning"),x=/([^a-zA-Z0-9 \-\'\|;,\.!_\*()])/g,queryObj.line=queryObj.line.replace(x,"")),queryObj.poly&&(x=/([^a-zA-Z0-9 \-\'\|;,\.!_\*()\\])/g,x.test(queryObj.poly)&&alert("Illegal characters were removed from the shape (polygon) labels.","Warning"),x=/([^a-zA-Z0-9 \-\'\|;,\.!_\*()])/g,queryObj.poly=queryObj.poly.replace(x,"")),queryObj.rect&&(x=/([^a-zA-Z0-9 \-\'\|;,\.!_\*()\\])/g,x.test(queryObj.rect)&&alert("Illegal characters were removed from the rectangle labels.","Warning"),x=/([^a-zA-Z0-9 \-\'\|;,\.!_\*()])/g,queryObj.rect=queryObj.rect.replace(x,"")),queryObj.text&&(x=/([^a-zA-Z0-9 \-\'\|;,\.!_\*()\\])/g,x.test(queryObj.text)&&alert("Illegal characters were removed from the point labels.","Warning"),x=/([^a-zA-Z0-9 \-\'\|;,\.!_\*()])/g,queryObj.text=queryObj.text.replace(x,"")),queryObj.layer&&(queryObj.layer=queryObj.layer.replace(/~/g," "),x=/([^a-zA-Z0-9 \-\|,\._()])/g,x.test(queryObj.layer)&&alert("Illegal characters were found on the URL. Layers may not load properly.","Warning"),queryObj.layer=queryObj.layer.replace(x,"")),queryObj.keyword&&(x=/([^a-zA-Z0-9 \-\._()])/g,x.test(queryObj.keyword)&&alert("Illegal characters were found on the URL. Location may not load properly.","Warning"),queryObj.keyword=queryObj.keyword.replace(x,"")),queryObj.value){x=/([^a-zA-Z0-9 \-\',\.!_\*()\\#/&])/g,x.test(queryObj.value)&&alert("Illegal characters were found on the URL. Location may not load properly.","Warning"),x=/([^a-zA-Z0-9 \-\',\.!_\*()#/&])/g,queryObj.value=queryObj.value.replace(x,"");var I=/'/g;queryObj.value=queryObj.value.replace(I,"''")}queryObj.label&&(x=/([^a-zA-Z0-9 \-\',\.!_\*()#&/\\])/g,x.test(queryObj.label)&&alert("Illegal characters were found on the URL. Point labels may not load properly.","Warning"),x=/([^a-zA-Z0-9 \-\',\.!_\*()#&/])/g,queryObj.label=queryObj.label.replace(x,"")),queryObj.map&&(x=/([^a-zA-Z0-9 \-,\._():\/])/g,x.test(queryObj.map)&&alert("Illegal characters were found on the URL. Map may not load properly.","Warning"),queryObj.map=queryObj.map.replace(x,"")),queryObj.field&&(x=/([^a-zA-Z0-9 \-_])/g,x.test(queryObj.field)&&alert("Illegal characters were found on the URL. Map may not load properly.","Warning"),queryObj.field=queryObj.field.replace(x,"")),queryObj.prj&&isNaN(queryObj.prj)&&(queryObj.prj=102100,alert("Problem reading map projection from the URL, defaulting to WGS84.","Warning")),queryObj.extent&&(x=/([^0-9 \-,\.])/g,x.test(queryObj.extent)&&alert("Illegal characters were found on the URL. Map extent may not load properly.","Warning"),queryObj.extent=queryObj.extent.replace(x,"")),queryObj.place&&(x=/([^a-zA-Z0-9 \-\',\.!_*():#&/\\])/g,x.test(queryObj.place)&&alert("Illegal characters were found on the URL. Location may not load properly.","Warning"),x=/([^a-zA-Z0-9 \-\',\.!_*():#&/])/g,queryObj.place=queryObj.place.replace(x,"")),document.getElementById("mapDescFile").href=app+"/definitions.html";var k=createXMLhttpRequest(),T=app+"/config.xml?v="+ndisVer;k.onreadystatechange=function(){if(4==k.readyState&&200===k.status){v=createXMLdoc(k);try{geometryService=v.getElementsByTagName("geometryservice")[0].getAttribute("url")}catch(e){alert("Missing tag: geometryservice in "+app+'/config.xml.\n\nTag should look like: &lt;geometryservice url="https://ndismaps.nrel.colostate.edu/ArcGIS/rest/services/Utilities/Geometry/GeometryServer"/&gt;\n\nWill use that url for now.',"Data Error"),geometryService="https://ndismaps.nrel.colostate.edu/ArcGIS/rest/services/Utilities/Geometry/GeometryServer"}try{printServiceUrl=v.getElementsByTagName("printservice")[0].firstChild.nodeValue}catch(e){alert("Missing tag: printservice in "+app+"/config.xml.\n\nTag should look like: &lt;printservice&gt;https://ndismaps.nrel.colostate.edu/arcgis/rest/services/Utilities/PrintingTools/GPServer/Export%20Web%20Map%20Task&lt;/printservice&gt;\n\nWill use that url for now.","Data Error"),printServiceUrl="https://ndismaps.nrel.colostate.edu/arcgis/rest/services/Utilities/PrintingTools/GPServer/Export%20Web%20Map%20Task"}try{printGeoServiceUrl=v.getElementsByTagName("printservicegeo")[0].firstChild.nodeValue}catch(e){alert("Missing tag: printservicegeo in "+app+"/config.xml.\n\nTag should look like: &lt;printservicegeo&gt;https://ndismaps.nrel.colostate.edu/arcgis/rest/services/PrintTemplate/georefPrinting/GPServer/georefPrinting&lt;/printservice&gt;\n\nWill use that url for now.","Data Error"),printGeoServiceUrl="https://ndismaps.nrel.colostate.edu/arcgis/rest/services/PrintTemplate/georefPrinting/GPServer/georefPrinting"}var r;try{r=v.getElementsByTagName("title")[0].firstChild.nodeValue}catch(e){alert("Warning: Missing title tag in "+app+"/config.xml file. "+e.message,"Data Error")}try{e.byId("title").innerHTML=r,document.title=r,e.byId("subtitle").innerHTML=v.getElementsByTagName("subtitle")[0].firstChild.nodeValue,e.byId("logo").src=v.getElementsByTagName("logo")[0].firstChild.nodeValue,e.byId("logourl").href=v.getElementsByTagName("logourl")[0].firstChild.nodeValue}catch(e){alert("Warning: Missing title, subtitle, logo, or logurl tag in "+app+"/config.xml file. "+e.message,"Data Error")}v.getElementsByTagName("noDisclaimer")&&v.getElementsByTagName("noDisclaimer")[0]&&"true"==v.getElementsByTagName("noDisclaimer")[0].firstChild.nodeValue||1!=getCookie("noDisclaimer")&&loadDisclaimer(r);try{myFindService=v.getElementsByTagName("findplaceservice")[0].getAttribute("url")}catch(e){alert("Missing tag: findplaceservice in "+app+'/config.xml.\n\nTag should look like: &lt;findplaceservice url="https://ndismaps.nrel.colostate.edu/ArcGIS/rest/services/GNIS_Loc/GeocodeServer"/&gt;\n\nWill use that url for now.',"Data Error"),myFindService="https://ndismaps.nrel.colostate.edu/ArcGIS/rest/services/GNIS_Loc/GeocodeServer"}try{h=v.getElementsByTagName("map")[0].getAttribute("initialextent").split(" "),wkid=parseInt(v.getElementsByTagName("map")[0].getAttribute("wkid").trim()),fullExtent=new d({xmin:parseFloat(h[0]),ymin:parseFloat(h[1]),xmax:parseFloat(h[2]),ymax:parseFloat(h[3]),spatialReference:{wkid:wkid}})}catch(e){alert("Warning: Missing tag attributes initalextent or wkid for the map tag in "+app+"/config.xml file. "+e.message,"Data Error")}var t=[{level:6,resolution:2445.98490512499,scale:9244648.868618},{level:7,resolution:1222.992452562495,scale:4622324.434309},{level:8,resolution:611.4962262813797,scale:2311162.217155},{level:9,resolution:305.74811314055756,scale:1155581.108577},{level:10,resolution:152.87405657041106,scale:577790.554289},{level:11,resolution:76.43702828507324,scale:288895.277144},{level:12,resolution:38.21851414253662,scale:144447.638572},{level:13,resolution:19.10925707126831,scale:72223.819286},{level:14,resolution:9.554628535634155,scale:36111.909643},{level:15,resolution:4.77731426794937,scale:18055.954822},{level:16,resolution:2.388657133974685,scale:9027.977411},{level:17,resolution:1.1943285668550503,scale:4513.988705},{level:18,resolution:.5971642835598172,scale:2256.994353},{level:19,resolution:.29858214164761665,scale:1128.497176}];try{require(["dojo/_base/Color","dojo/dom-construct"],function(e,r){map=new n({basemap:"streets-vector",lods:t}),view=new o({container:"mapDiv",extent:fullExtent,map:map,constraints:{maxScale:9244649,minScale:1128}})})}catch(e){alert("Error creating map in readConfig.js. "+e.message,"Code Error",e)}if(view.when("load",function(){view.on("pointer-move",e=>{showCoordinates(e)}),view.on("click",e=>{console.log("Identify")}),reactiveUtils.watch(()=>view.zoom,()=>{showMapScale(parseInt(view.scale))},{initial:!0}),view.on("update-start",showLoading),vuew.on("update-end",hideLoading),require(["esri/widget/Scalebar"],function(e){new e({map:map,scalebarUnit:"dual"})}),showMapScale(view.scale),f(),addOverviewMap(),hideLoading()}),queryObj.extent&&""!=queryObj.extent){var a,i=[];i="[object Array]"===Object.prototype.toString.call(queryObj.extent)?queryObj.extent[0].split(","):queryObj.extent.split(","),a=queryObj.prj&&""!=queryObj.prj?queryObj.prj:i[0]<0&&i[0]>-200?4326:26913,h=new d({xmin:parseFloat(i[0]),ymin:parseFloat(i[1]),xmax:parseFloat(i[2]),ymax:parseFloat(i[3]),spatialReference:{wkid:parseInt(a)}});var u=new y;u.geometries=[h],u.outSR=new s(wkid),l.project(geometryService,u,function(e){initExtent=e[0],view.extent=initExtent},function(e){alert("There was a problem converting the extent read from the URL to Web Mercator projection. extent="+i[0],", "+i[1]+", "+i[2]+", "+i[3]+"  prj="+a+"  "+e.message,"URL Extent Error",e)})}else initExtent=new d({xmin:parseFloat(h[0]),ymin:parseFloat(h[1]),xmax:parseFloat(h[2]),ymax:parseFloat(h[3]),spatialReference:{wkid:wkid}}),view.extent=initExtent;if(queryObj.place&&""!=queryObj.place){var g=queryObj.place.replace("%20"," ");queryObj.prj&&""!=queryObj.prj&&(settings={XYProjection:queryObj.prj}),gotoLocation(g,!0)}queryObj.keyword&&""!=queryObj.keyword&&(queryObj.value&&""!=queryObj.value?require(["esri/request","esri/tasks/QueryTask","esri/tasks/query"],function(e,r,t){var a=app+"/url.xml?v="+ndisVer,i=createXMLhttpRequest();i.onreadystatechange=function(){if(4==i.readyState&&200===i.status){for(var e=createXMLdoc(i),a=e.getElementsByTagName("layer"),l=0;l<a.length&&(a[l].getElementsByTagName("keyword")[0]&&a[l].getElementsByTagName("keyword")[0].firstChild||alert("Missing tag keyword or blank, in "+app+"/url.xml file.","Data Error"),queryObj.keyword!=a[l].getElementsByTagName("keyword")[0].firstChild.nodeValue);l++);if(l==a.length)alert("Keyword ["+queryObj.keyword+"] is not defined in "+app+"/url.xml file.","Data Error");else if(a[l].getElementsByTagName("url")[0]&&a[l].getElementsByTagName("url")[0].firstChild||alert("Missing tag url or blank, in "+app+"/url.xml file for keyword: "+queryObj.keyword+".","Data Error"),a[l].getElementsByTagName("expression")[0]&&a[l].getElementsByTagName("expression")[0].firstChild){var s=a[l].getElementsByTagName("expression")[0].firstChild.nodeValue.replace("[value]",queryObj.value),n=new r(a[l].getElementsByTagName("url")[0].firstChild.nodeValue),o=new t;o.where=s,o.returnGeometry=!0,n.execute(o,function(e){0==e.features.length?gotoLocation(queryObj.value,!0):require(["esri/geometry/Point","esri/graphicsUtils","esri/layers/GraphicsLayer","esri/graphic","esri/symbols/PictureMarkerSymbol"],function(r,t,i,s,n){var o,y;if("esriGeometryPoint"==e.geometryType){var u=8;if(a[l].getElementsByTagName("mapscale")[0]&&a[l].getElementsByTagName("mapscale")[0].firstChild&&(u=parseInt(a[l].getElementsByTagName("mapscale")[0].firstChild.nodeValue)),u>11&&(u=8),o=new r(e.features[0].geometry.x,e.features[0].geometry.y,e.spatialReference),map.centerAndZoom(o,u),queryObj.label&&""!=queryObj.label){y=new i,y.id="searchgraphics"+searchGraphicsCounter,searchGraphicsCount.push(y.id),searchGraphicsCounter++,addLabel(new s(o),queryObj.label,y,"11pt");var g=new n("assets/images/yellowdot.png",30,30);y.add(new s(o,g)),document.getElementById("findClear").style.opacity=1,document.getElementById("findClear").style.filter="alpha(opacity=100)"}}else if("esriGeometryPolygon"==e.geometryType){var c=!1;if(a[l].getElementsByTagName("union")[0]&&a[l].getElementsByTagName("union")[0].firstChild&&"true"===a[l].getElementsByTagName("union")[0].firstChild.nodeValue.toLowerCase()&&(c=!0),c){for(var p=new d(e.features[0].geometry.getExtent()),m=0;m<e.features.length;m++){var b=e.features[m].geometry.getExtent();p=p.union(b)}map.setExtent(p),o=p.getCenter()}else o=e.features[0].geometry.getCentroid(),map.setExtent(e.features[0].geometry.getExtent(),!0);queryObj.label&&""!=queryObj.label&&(y=new i,y.id="searchgraphics"+searchGraphicsCounter,searchGraphicsCount.push(y.id),searchGraphicsCounter++,addLabel(new s(o),queryObj.label,y,"11pt"),document.getElementById("findClear").style.opacity=1,document.getElementById("findClear").style.filter="alpha(opacity=100)")}else map.setExtent(e.features[0].geometry.getExtent(),!0)})},function(e){e.responseText?(alert("Error: QueryTask failed for keyword="+queryObj.keyword+" value="+queryObj.value+" "+e.message+e.responseText,"URL Keyword/Value Error",e),document.execCommand("Stop")):(alert("Error: QueryTask failed for keyword="+queryObj.keyword+" value="+queryObj.value+" "+e.message,"URL Keyword/Value Error",e),document.execCommand("Stop"))})}else alert("Missing tag expression, in "+app+"/url.xml file for keyword: "+queryObj.keyword,"Data Error")}else 404===i.status?alert("Missing url.xml file in "+app+" directory.","Data Error"):4===i.readyState&&500===i.status&&alert("Error: had trouble reading "+app+"/url.xml file in readConfig.js.","Data Error")},i.open("GET",a,!0),i.send(null)}):alert("When &keyword is used on the URL, there must be a &value also.","URL Keyword/Value Error")),queryObj.map&&""!=queryObj.map&&(queryObj.value&&""!=queryObj.value&&queryObj.field&&""!=queryObj.field?require(["esri/request","esri/tasks/QueryTask","esri/tasks/query"],function(e,r,t){var a=new r(queryObj.map),i=new t;Number(queryObj.value)?i.where=queryObj.field+"="+queryObj.value:i.where="UPPER("+queryObj.field+") LIKE UPPER('"+queryObj.value+"')",i.returnGeometry=!0,a.execute(i,function(e){require(["esri/geometry/Point","esri/graphicsUtils"],function(r,t){0==e.features.length?alert("Cannot zoom to "+queryObj.value+". The feature was not found in "+queryObj.map+" for field "+queryObj.field,"URL Map/Value Error"):"esriGeometryPoint"==e.geometryType?map.centerAndZoom(new r(e.features[0].geometry.x,e.features[0].geometry.y,e.spatialReference),8):map.setExtent(e.features[0].geometry.getExtent(),!0)})},function(e){e.responseText?alert("Error: QueryTask failed for map="+queryObj.map+" "+e.message+e.responseText,"URL Map/Value Error",e):alert("Error: QueryTask failed for map="+queryObj.map+" "+e.message,"URL Map/Value Error",e)})}):alert("When &map is used on the URL, there must also be an &field and &value.","URL Map/Value Error"))}else 404===k.status?(alert("Error: Missing config.xml file in "+app+" directory.","Data Error"),hideLoading()):4===k.readyState&&500===k.status&&(alert("Make sure your application name is correct on the URL. app="+app,"Warning"),hideLoading())},k.open("GET",T,!0),k.send(null)}catch(e){alert("Error in javascript/readConfig.js. "+e.message,"Code Error",e)}})}var locator,layerObj,addressGraphicsCount=[],addressGraphicsCounter=0;