function readSettingsWidget(){var e=createXMLhttpRequest(),t=app+"/SettingsWidget.xml?v="+ndisVer;e.onreadystatechange=function(){if(4==e.readyState&&200==e.status)try{require(["dojo/dom","dijit/registry","dojo/query","dojo/dom-construct","dojo/on"],function(t,i,a,r,n){var s=createXMLdoc(e),d=getCookie("prj");settings=""!==d?{XYProjection:d}:{XYProjection:s.getElementsByTagName("xy_projection")[0].childNodes[0].nodeValue},document.getElementById("settings_xycoords_combo").value=settings.XYProjection,use_map_link=s.getElementsByTagName("use_map_link")[0]&&"true"==s.getElementsByTagName("use_map_link")[0].childNodes[0].nodeValue?1:0,use_map_link&&(document.getElementById("mapLinkBtn").style.display="block"),use_get_extent=s.getElementsByTagName("use_get_extent")&&"true"==s.getElementsByTagName("use_get_extent")[0].childNodes[0].nodeValue?1:0,use_get_extent&&(document.getElementById("showExtentBtn").style.display="block");var l=s.getElementsByTagName("use_gmus")[0]&&"true"==s.getElementsByTagName("use_gmus")[0].childNodes[0].nodeValue?1:0;l?(settings.useGMUs=!0,s.getElementsByTagName("gmu_url")[0]?settings.elkUrl=s.getElementsByTagName("gmu_url")[0].childNodes[0].nodeValue:alert("Missing tag: gmu_url in "+app+"/SettingsWidget.xml","Data Error"),s.getElementsByTagName("gmu_field")[0]?settings.elkField=s.getElementsByTagName("gmu_field")[0].childNodes[0].nodeValue:alert("Missing tag: gmu_field in "+app+"/SettingsWidget.xml","Data Error"),s.getElementsByTagName("sheep_gmu_url")[0]?settings.sheepUrl=s.getElementsByTagName("sheep_gmu_url")[0].childNodes[0].nodeValue:alert("Missing tag: sheep_gmu_url in "+app+"/SettingsWidget.xml","Data Error"),s.getElementsByTagName("sheep_gmu_field")[0]?settings.sheepField=s.getElementsByTagName("sheep_gmu_field")[0].childNodes[0].nodeValue:alert("Missing tag: sheep_gmu_field in "+app+"/SettingsWidget.xml","Data Error"),s.getElementsByTagName("goat_gmu_url")[0]?settings.goatUrl=s.getElementsByTagName("goat_gmu_url")[0].childNodes[0].nodeValue:alert("Missing tag: goat_gmu_url in "+app+"/SettingsWidget.xml","Data Error"),s.getElementsByTagName("goat_gmu_field")[0]?settings.goatField=s.getElementsByTagName("goat_gmu_field")[0].childNodes[0].nodeValue:alert("Missing tag: goat_gmu_field in "+app+"/SettingsWidget.xml","Data Error"),"Big Game GMU"==gmu?showGMUCombo(settings.elkUrl,settings.elkField):"Bighorn GMU"==gmu?showGMUCombo(settings.sheepUrl,settings.sheepField):"Goat GMU"==gmu&&showGMUCombo(settings.goatUrl,settings.goatField)):settings.useGMUs=!1,driving_directions=s.getElementsByTagName("driving_directions")[0]&&"true"==s.getElementsByTagName("driving_directions")[0].childNodes[0].nodeValue?1:0,s.getElementsByTagName("elevation")[0]&&s.getElementsByTagName("elevation")[0].firstChild.nodeValue&&(show_elevation="true"==s.getElementsByTagName("elevation")[0].firstChild.nodeValue?1:0),show_elevation&&s.getElementsByTagName("elevation_url")[0]&&(s.getElementsByTagName("elevation_url")[0].firstChild.nodeValue?elevation_url=s.getElementsByTagName("elevation_url")[0].firstChild.nodeValue:alert("Missing elevation_url tag in SettingsWidget.xml.","Data Error")),folder=s.getElementsByTagName("folder");for(var o=0;o<folder.length;o++){0==o&&(identifyGroup=folder[o].getAttribute("label")),identifyGroups.push(folder[o].getAttribute("label")),identifyLayerIds[identifyGroups[o]]=[];var y=folder[o].getElementsByTagName("layer");identifyLayers[identifyGroups[o]]={},folder[o].getElementsByTagName("desc")[0]&&(identifyLayers[identifyGroups[o]].desc=folder[o].getElementsByTagName("desc")[0].firstChild.nodeValue);for(var f="missing label",u=0;u<y.length;u++){y[u].getAttribute("label")?f=y[u].getAttribute("label"):alert("Error in "+app+"/SettingsWidget.xml. Missing label in folder: "+identifyGroups[o]+".","Data Error"),folder[o].getAttribute("id_vis_only")&&"true"==folder[o].getAttribute("id_vis_only").toLowerCase()&&(y[u].getElementsByTagName("vis_url")[0]&&y[u].getElementsByTagName("vis_id")[0]||alert("Error in "+app+"/SettingsWidget.xml. When vis_id_only is set in a folder, every layer in the folder must have a vis_id and vis_url tag for the layer that is in the map to check if it is visible or not. Missing vis_url and vis_id tags in folder: "+identifyGroups[o]+".","Data Error")),identifyLayers[identifyGroups[o]][f]={};var g=!1;if(y[u].getElementsByTagName("url")[0]&&y[u].getElementsByTagName("id")[0])for(var p=0;p<identifyLayerIds[identifyGroups[o]].length;p++)folder[o].getAttribute("id_vis_only")&&"true"==folder[o].getAttribute("id_vis_only").toLowerCase()&&identifyLayerIds[identifyGroups[o]][p].url==y[u].getElementsByTagName("url")[0].childNodes[0].nodeValue&&identifyLayerIds[identifyGroups[o]][p].vis_url==y[u].getElementsByTagName("vis_url")[0].childNodes[0].nodeValue&&identifyLayerIds[identifyGroups[o]][p].geometry==y[u].getElementsByTagName("geometry")[0].childNodes[0].nodeValue.toLowerCase()?(identifyLayerIds[identifyGroups[o]][p].ids.push(y[u].getElementsByTagName("id")[0].childNodes[0].nodeValue),identifyLayerIds[identifyGroups[o]][p].vis_ids.push(y[u].getElementsByTagName("vis_id")[0].childNodes[0].nodeValue),g=!0):identifyLayerIds[identifyGroups[o]][p].url==y[u].getElementsByTagName("url")[0].childNodes[0].nodeValue&&identifyLayerIds[identifyGroups[o]][p].geometry==y[u].getElementsByTagName("geometry")[0].childNodes[0].nodeValue.toLowerCase()&&(identifyLayerIds[identifyGroups[o]][p].ids.push(y[u].getElementsByTagName("id")[0].childNodes[0].nodeValue),g=!0);else alert("Error in "+app+"/SettingsWidget.xml. Missing url or id in folder: "+identifyGroups[o]+" for layer: "+f+".","Data Error");if(!g)if(y[u].getElementsByTagName("url")[0]&&y[u].getElementsByTagName("id")[0]){var m=null,c=[];folder[o].getAttribute("id_vis_only")&&"true"==folder[o].getAttribute("id_vis_only").toLowerCase()&&(m=y[u].getElementsByTagName("vis_url")[0].childNodes[0].nodeValue,c.push(y[u].getElementsByTagName("vis_id")[0].childNodes[0].nodeValue)),identifyLayerIds[identifyGroups[o]].push({url:y[u].getElementsByTagName("url")[0].childNodes[0].nodeValue,ids:new Array(y[u].getElementsByTagName("id")[0].childNodes[0].nodeValue),geometry:y[u].getElementsByTagName("geometry")[0].childNodes[0].nodeValue.toLowerCase(),id_vis_only:!(!folder[o].getAttribute("id_vis_only")||"true"!=folder[o].getAttribute("id_vis_only").toLowerCase()),vis_url:m,vis_ids:c})}else alert("Error in "+app+"/SettingsWidget.xml. Missing url or id in folder: "+identifyGroups[o]+" for layer: "+f+".","Data Error");y[u].getElementsByTagName("database")[0]?(y[u].getElementsByTagName("url")[0]?identifyLayers[identifyGroups[o]][f].url=y[u].getElementsByTagName("url")[0].childNodes[0].nodeValue:alert("Error in "+app+"/SettingsWidget.xml. Missing url in folder: "+identifyGroups[o]+" for layer: "+f+".","Data Error"),y[u].getElementsByTagName("id")[0]?identifyLayers[identifyGroups[o]][f].id=y[u].getElementsByTagName("id")[0].childNodes[0].nodeValue:alert("Error in "+app+"/SettingsWidget.xml. Missing id in folder: "+identifyGroups[o]+" for layer: "+f+".","Data Error"),y[u].getElementsByTagName("geometry")[0]?identifyLayers[identifyGroups[o]][f].geometry=y[u].getElementsByTagName("geometry")[0].childNodes[0].nodeValue:alert("Error in "+app+"/SettingsWidget.xml. Missing geometry in folder: "+identifyGroups[o]+" for layer: "+f+".","Data Error"),y[u].getElementsByTagName("fields")[0]?identifyLayers[identifyGroups[o]][f].fields=y[u].getElementsByTagName("fields")[0].childNodes[0].nodeValue.split(","):alert("Error in "+app+"/SettingsWidget.xml. Missing fields in folder: "+identifyGroups[o]+" for layer: "+f+".","Data Error"),y[u].getElementsByTagName("displaynames")[0]?identifyLayers[identifyGroups[o]][f].displaynames=y[u].getElementsByTagName("displaynames")[0].childNodes[0].nodeValue.split(","):alert("Error in "+app+"/SettingsWidget.xml. Missing displaynames in folder: "+identifyGroups[o]+" for layer: "+f+".","Data Error"),y[u].getElementsByTagName("position")[0]?identifyLayers[identifyGroups[o]][f].position=y[u].getElementsByTagName("position")[0].childNodes[0].nodeValue:identifyLayers[identifyGroups[o]][f].position=0,y[u].getElementsByTagName("database")[0]?identifyLayers[identifyGroups[o]][f].database=y[u].getElementsByTagName("database")[0].childNodes[0].nodeValue:alert("Error in "+app+"/SettingsWidget.xml. Missing database in folder: "+identifyGroups[o]+" for layer: "+f+".","Data Error"),y[u].getElementsByTagName("filename")[0]?identifyLayers[identifyGroups[o]][f].filename=y[u].getElementsByTagName("filename")[0].childNodes[0].nodeValue:alert("Error in "+app+"/SettingsWidget.xml. Missing filename in folder: "+identifyGroups[o]+" for layer: "+f+".","Data Error"),y[u].getElementsByTagName("one2one_fields")[0]&&y[u].getElementsByTagName("one2one_fields")[0].childNodes.length>0&&(identifyLayers[identifyGroups[o]][f].one2one_fields=y[u].getElementsByTagName("one2one_fields")[0].childNodes[0].nodeValue.split(",")),y[u].getElementsByTagName("one2one_display")[0]&&y[u].getElementsByTagName("one2one_display")[0].childNodes.length>0&&(identifyLayers[identifyGroups[o]][f].one2one_display=y[u].getElementsByTagName("one2one_display")[0].childNodes[0].nodeValue.split(",")),y[u].getElementsByTagName("one2many_fields")[0]&&y[u].getElementsByTagName("one2many_fields")[0].childNodes.length>0&&(identifyLayers[identifyGroups[o]][f].one2many_fields=y[u].getElementsByTagName("one2many_fields")[0].childNodes[0].nodeValue.split(","))):(y[u].getElementsByTagName("url")[0]?identifyLayers[identifyGroups[o]][f].url=y[u].getElementsByTagName("url")[0].childNodes[0].nodeValue:alert("Error in "+app+"/SettingsWidget.xml. Missing url in folder: "+identifyGroups[o]+" for layer: "+f+".","Data Error"),y[u].getElementsByTagName("id")[0]?identifyLayers[identifyGroups[o]][f].id=y[u].getElementsByTagName("id")[0].childNodes[0].nodeValue:alert("Error in "+app+"/SettingsWidget.xml. Missing id in folder: "+identifyGroups[o]+" for layer: "+f+".","Data Error"),y[u].getElementsByTagName("geometry")[0]?identifyLayers[identifyGroups[o]][f].geometry=y[u].getElementsByTagName("geometry")[0].childNodes[0].nodeValue:alert("Error in "+app+"/SettingsWidget.xml. Missing geometry in folder: "+identifyGroups[o]+" for layer: "+f+".","Data Error"),y[u].getElementsByTagName("fields")[0]?identifyLayers[identifyGroups[o]][f].fields=y[u].getElementsByTagName("fields")[0].childNodes[0].nodeValue.split(","):alert("Error in "+app+"/SettingsWidget.xml. Missing fields in folder: "+identifyGroups[o]+" for layer: "+f+".","Data Error"),y[u].getElementsByTagName("displaynames")[0]?identifyLayers[identifyGroups[o]][f].displaynames=y[u].getElementsByTagName("displaynames")[0].childNodes[0].nodeValue.split(","):alert("Error in "+app+"/SettingsWidget.xml. Missing displaynames in folder: "+identifyGroups[o]+" for layer: "+f+".","Data Error"),"Big Game GMU Boundaries"==f&&(identifyLayers[identifyGroups[o]]["Bighorn GMU"]={},identifyLayers[identifyGroups[o]]["Bighorn GMU"].url=settings.sheepUrl.slice(0,settings.sheepUrl.length-2),identifyLayers[identifyGroups[o]]["Bighorn GMU"].id=settings.sheepUrl.slice(settings.sheepUrl.length-1),identifyLayers[identifyGroups[o]]["Bighorn GMU"].geometry="polygon",identifyLayers[identifyGroups[o]]["Bighorn GMU"].fields=[settings.sheepField],identifyLayers[identifyGroups[o]]["Bighorn GMU"].displaynames=["GMU Number"],identifyLayers[identifyGroups[o]]["Goat GMU"]={},identifyLayers[identifyGroups[o]]["Goat GMU"].url=settings.goatUrl.slice(0,settings.goatUrl.length-2),identifyLayers[identifyGroups[o]]["Goat GMU"].id=settings.goatUrl.slice(settings.goatUrl.length-1),identifyLayers[identifyGroups[o]]["Goat GMU"].geometry="polygon",identifyLayers[identifyGroups[o]]["Goat GMU"].fields=[settings.goatField],identifyLayers[identifyGroups[o]]["Goat GMU"].displaynames=["GMU Number"]))}}})}catch(e){alert("Error reading "+app+"/SettingsWidget.xml in javascript/identify.js readSettingsWidget(): "+e.message,"Data Error",e),hideLoading("")}else 404===e.status?(alert("Error: Missing "+app+"/settingsWidget.xml file.","Data Error"),hideLoading()):4===e.readyState&&500===e.status&&(alert("Error reading "+app+"/settingsWidget.xml.","Code Error"),hideLoading())},e.open("GET",t,!0),e.send()}function doIdentify(e){showLoading(),"function"==typeof gtag&&gtag("event","widget_click",{widget_name:"Identify"}),numDatabaseCalls=0,processedDatabaseCalls=0,features=[],theEvt=e,view.popup.title="Identify";for(var t=0;t<identifyGroups.length;t++)groupContent[identifyGroups[t]]=null,theTitle[identifyGroups[t]]=null;clickPoint=e.mapPoint,displayContent()}function setIdentifyHeader(){var e=document.getElementsByClassName("esri-popup__main-container")[0];if(e&&0!=e.childNodes.length){title="<span style='float:left;text-overflow:ellipsis;'>Show: <select id='id_group' name='id_group' style='margin: 5px;color:black;' onChange='changeIdentifyGroup(this)'>";for(var t=0;t<identifyGroups.length;t++)title+="<option",identifyGroup==identifyGroups[t]&&(title+=" selected"),title+=">"+identifyGroups[t]+"</option>";if(title+="</select></span>",0==e.childNodes[0].childNodes[0].childNodes[0].innerHTML.indexOf("<h"))e=e.childNodes[0].childNodes[0].childNodes[0].childNodes[0],e.innerHTML=title;else{e=e.childNodes[0].childNodes[0].childNodes[0].childNodes[0];var i=document.createElement("h2");i.slot="header-content",i.ariaLevel="2",i.classList="esri-widget__heading esri-features__heading",i.role="heading",i.innerHTML=title,e.parentNode.insertBefore(i,e)}}}function displayContent(){if(groupContent[identifyGroup])return view.popup.title=theTitle[identifyGroup],void displayInfoWindow(groupContent[identifyGroup]);require(["esri/rest/identify","dojo/promise/all","esri/rest/query","esri/rest/support/Query"],function(e,t,i,a){try{identifyParams.geometry=clickPoint,identifyParams.mapExtent=view.extent,identifyParams.width=view.width,identifyParams.height=view.height;for(var r=-1,n=[],s=0;s<identifyLayerIds[identifyGroup].length;s++){var d=identifyLayerIds[identifyGroup][s];if(d){if(d.url.indexOf("Wildfire")>-1||d.url.indexOf("WFIGS")>-1){params=new a({returnGeometry:!0,geometry:clickPoint,spatialRelationship:"intersects",outSpatialReference:map.spatialReference}),identifyLayers[identifyGroup]["Wildfire Incidents"]&&identifyLayers[identifyGroup]["Wildfire Incidents"].url===d.url?(params.outFields=identifyLayers[identifyGroup]["Wildfire Incidents"].fields,view.scale<=36112?params.distance=.25:view.scale<=144448?params.distance=.5:view.scale<=577791?params.distance=1:view.scale<=2311162?params.distance=4:params.distance=10,params.units="miles"):identifyLayers[identifyGroup]["Wildfire Perimeters"]&&identifyLayers[identifyGroup]["Wildfire Perimeters"].url===d.url?params.outFields=identifyLayers[identifyGroup]["Wildfire Perimeters"].fields:alert("In SettingsWidget.xml tag Wildfire folder, must contain layers with the following names: Wildfire Incidents or Wildfire Perimeters.","Data Error"),r=!0,n.push(i.executeQueryJSON(d.url,params).then(identifySuccess).catch(handleQueryError));continue}var l;if(identifyParams.layerIds=d.ids.slice(),"polygon"!=d.geometry?view.scale<=36112?identifyParams.tolerance=25:view.scale<=288895?identifyParams.tolerance=20:identifyParams.tolerance=10:identifyParams.tolerance=1,d.id_vis_only?(identifyParams.layerOption="visible",l=d.vis_url,"/"==d.vis_url[d.vis_url.length-1]&&(l=d.vis_url.substr(0,d.vis_url.length-1)),r=!1):(r=!1,l=d.url),settings.elkUrl&&d.url==settings.elkUrl.slice(0,settings.elkUrl.lastIndexOf("/")+1)&&"Big Game GMU"!=gmu){var o=identifyParams.layerIds.indexOf(settings.elkUrl.slice(settings.elkUrl.lastIndexOf("/")+1));o>-1&&identifyParams.layerIds.splice(o,1)}0==identifyParams.layerIds.length&&(r=!0),r||n.push(e.identify(l,identifyParams).then(identifySuccess).catch(handleQueryError))}}if("GMU and Land Management"===identifyGroup&&("Bighorn GMU"==gmu?(identifyParams.tolerance=1,identifyParams.layerIds=[settings.sheepUrl.slice(settings.sheepUrl.lastIndexOf("/")+1)],n.push(e.identify(settings.sheepUrl.slice(0,settings.sheepUrl.lastIndexOf("/")+1),identifyParams).then(identifySuccess).catch(handleQueryError))):"Goat GMU"==gmu&&(identifyParams.tolerance=1,identifyParams.layerIds=[settings.goatUrl.slice(settings.goatUrl.lastIndexOf("/")+1)],n.push(e.identify(settings.goatUrl.slice(0,settings.goatUrl.lastIndexOf("/")+1),identifyParams).then(identifySuccess).catch(handleQueryError)))),n&&n.length>0){var y=t(n);y.then(handleQueryResults)}else numDatabaseCalls=0,processedDatabaseCalls=0,features=[],accumulateContent("")}catch(e){alert("Problem trying to identify. Error message: "+e.message,"Warning"),hideLoading("")}})}function identifySuccess(e){return e.results?e.results:e}function handleQueryError(e){e.message.indexOf("Too many requests")>-1?tooManyRequests=!0:(e.details?alert("Error in identify.js/doIdentify.  "+e.details+" "+e.message+" Check "+app+"/SettingsWidget.xml urls.","Data Error"):alert("Error in identify.js/doIdentify.  "+e.message+" Check "+app+"/SettingsWidget.xml urls.","Data Error"),hideLoading(""))}function numberWithCommas(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}function handleQueryResults(e){try{if(!e)return void alert("Error in identify.js/handleQueryResults. Identify returned null.","Data Error");var t="",a="";if(identifyGroup.indexOf("Wildfire")>-1){for(var r=0;r<e.length;r++)e[r].features||(tooManyRequests=!0);if(tooManyRequests)return displayInfoWindow("<p>Too many people are requesting this data. Please try again.</p>"),void(tooManyRequests=!1);tooManyRequests=!1;var n=!0;return a="The wildfire map layers are maintained and imported on demand from ESRI's USA Current Wildfires layer. They present the best-known point and perimeter locations of wildfire occurrences within the United States over the past 7 days from IRWIN and NIFC information.<br/><br/>",e.forEach(function(e){e.features.length>0&&(n=!1),e.features.forEach(function(e){var i,r="Wildfire Incidents";e.attributes.IncidentName&&(a+="<h3 style='margin-bottom: 5px;margin-top: 5px;'>"+e.attributes.IncidentName+"</h3><strong>"+r+"</strong><div style='padding-left: 10px;'>",theTitle[identifyGroup]=e.attributes.IncidentName,view.popup.title=theTitle[identifyGroup]);for(var n=0;n<identifyLayers[identifyGroup][r].displaynames.length;n++){if(t="",e.attributes[identifyLayers[identifyGroup][r].fields[n]]&&"IncidentName"!==identifyLayers[identifyGroup][r].fields[n]&&"irwinid"!==identifyLayers[identifyGroup][r].fields[n].toLowerCase()&&" "!==e.attributes[identifyLayers[identifyGroup][r].fields[n]]&&"Null"!==e.attributes[identifyLayers[identifyGroup][r].fields[n]]&&""!==e.attributes[identifyLayers[identifyGroup][r].fields[n]])if("string"==typeof e.attributes[identifyLayers[identifyGroup][r].fields[n]]&&"http"==e.attributes[identifyLayers[identifyGroup][r].fields[n]].substring(0,4))t="<a href='"+e.attributes[identifyLayers[identifyGroup][r].fields[n]]+"' target='_blank'>"+identifyLayers[identifyGroup][r].displaynames[n]+"</a><br/>";else if(identifyLayers[identifyGroup][r].displaynames[n].toLowerCase().indexOf("percent")>-1)t=identifyLayers[identifyGroup][r].displaynames[n]+": "+e.attributes[identifyLayers[identifyGroup][r].fields[n]]+"%<br/>";else if(identifyLayers[identifyGroup][r].displaynames[n].toLowerCase().indexOf("updated")>-1){i=Date.now()-e.attributes[identifyLayers[identifyGroup][r].fields[n]];const a=Math.trunc(i/1e3/60/60/24),o=Math.trunc(i/1e3/60/60-24*a),y=Math.trunc(i/1e3/60-60*o);var s="days";1==a&&(s="day");var d="hours";1==o&&(d="hour");var l="minutes";1==y&&(l="minute"),t=a>=1?o>=1?identifyLayers[identifyGroup][r].displaynames[n]+": "+a+" "+s+" "+o+" "+d+" ago<br/>":identifyLayers[identifyGroup][r].displaynames[n]+": "+a+" "+s+" ago<br/>":o>=1?y>=1?identifyLayers[identifyGroup][r].displaynames[n]+": "+o+" "+d+" "+y+" "+l+" ago<br/>":identifyLayers[identifyGroup][r].displaynames[n]+": "+o+" "+d+" ago<br/>":identifyLayers[identifyGroup][r].displaynames[n]+": "+y+" "+l+" ago<br/>"}else identifyLayers[identifyGroup][r].displaynames[n].toLowerCase().indexOf("date")>-1?(i=new Date(e.attributes[identifyLayers[identifyGroup][r].fields[n]]),t=identifyLayers[identifyGroup][r].displaynames[n]+": "+(i.getMonth()+1)+"/"+i.getDate()+"/"+i.getFullYear()+"<br/>"):t=identifyLayers[identifyGroup][r].displaynames[n].toLowerCase().indexOf("acre")>-1||identifyLayers[identifyGroup][r].displaynames[n].toLowerCase().indexOf("size")>-1||identifyLayers[identifyGroup][r].displaynames[n].toLowerCase().indexOf("final")>-1||identifyLayers[identifyGroup][r].displaynames[n].toLowerCase().indexOf("burned")>-1?e.attributes[identifyLayers[identifyGroup][r].fields[n]]>=1?identifyLayers[identifyGroup][r].displaynames[n]+": "+numberWithCommas(Math.round(e.attributes[identifyLayers[identifyGroup][r].fields[n]]))+" Acres<br/>":identifyLayers[identifyGroup][r].displaynames[n]+": "+numberWithCommas(e.attributes[identifyLayers[identifyGroup][r].fields[n]].toFixed(2))+" Acres<br/>":identifyLayers[identifyGroup][r].displaynames[n]+": "+e.attributes[identifyLayers[identifyGroup][r].fields[n]]+"<br/>";a+=t}a+="</div><br/>"})}),void(n?(displayInfoWindow("No wildfires at this point."),theTitle[identifyGroup]="No Wildfires",view.popup.title="No Wildfires",groupContent[identifyGroup]="No wildfires at this point."):(a+="Inciweb: <a href='https://inciweb.wildfire.gov/state/colorado' target='_blank'>https://inciweb.wildfire.gov/state/colorado</a><br/>",groupContent[identifyGroup]=a,displayInfoWindow(a)))}for(e.forEach(function(e){e&&e.length>0&&e.forEach(function(e){void 0!==identifyLayers[identifyGroup][e.layerName]&&void 0!==identifyLayers[identifyGroup][e.layerName].database&&numDatabaseCalls++})}),index=0;XMLHttpRequestObjects.length>0;)XMLHttpRequestObjects.pop();e.forEach(function(e){e.length>0&&e.forEach(function(e){var r,n=e.feature;if(n.attributes.layerName=e.layerName,void 0!==identifyLayers[identifyGroup][e.layerName])if(void 0!==identifyLayers[identifyGroup][e.layerName].database)try{createMultiXMLhttpRequest();var s=app+"/"+identifyLayers[identifyGroup][e.layerName].database+"?v="+ndisVer+"&key="+e.feature.attributes[identifyLayers[identifyGroup][e.layerName].fields[0]];XMLHttpRequestObjects[index].open("GET",s,!0),XMLHttpRequestObjects[index].onreadystatechange=(r=index,function(){if(4==XMLHttpRequestObjects[r].readyState){if(200==XMLHttpRequestObjects[r].status){t=e.layerName+"</strong><div style='padding-left: 10px;'>";var i=createXMLdoc(XMLHttpRequestObjects[r]);for(-1!=e.layerName.indexOf("GMU")?theTitle[identifyGroup]="GMU "+e.feature.attributes[identifyLayers[identifyGroup][e.layerName].fields[0]]:theTitle[identifyGroup]=e.feature.attributes[identifyLayers[identifyGroup][e.layerName].fields[0]],view.popup.title=theTitle[identifyGroup],y=0;y<identifyLayers[identifyGroup][e.layerName].displaynames.length;y++)if(y>0&&e.feature.attributes[identifyLayers[identifyGroup][e.layerName].fields[y]]&&" "!==e.feature.attributes[identifyLayers[identifyGroup][e.layerName].fields[y]]&&"Null"!==e.feature.attributes[identifyLayers[identifyGroup][e.layerName].fields[y]]&&""!==e.feature.attributes[identifyLayers[identifyGroup][e.layerName].fields[y]]&&("string"==typeof e.feature.attributes[identifyLayers[identifyGroup][e.layerName].fields[y]]&&"http"==e.feature.attributes[identifyLayers[identifyGroup][e.layerName].fields[y]].substring(0,4)?t+="<a href='"+e.feature.attributes[identifyLayers[identifyGroup][e.layerName].fields[y]]+"' target='_blank'>"+identifyLayers[identifyGroup][e.layerName].displaynames[y]+"</a>":"<a href"==e.feature.attributes[identifyLayers[identifyGroup][e.layerName].fields[y]].substring(0,7)&&-1==e.feature.attributes[identifyLayers[identifyGroup][e.layerName].fields[y]].indexOf("target")?t+=identifyLayers[identifyGroup][e.layerName].displaynames[y]+": "+e.feature.attributes[identifyLayers[identifyGroup][e.layerName].fields[y]].replace(">"," target='_blank'>"):t+=identifyLayers[identifyGroup][e.layerName].displaynames[y]+": "+e.feature.attributes[identifyLayers[identifyGroup][e.layerName].fields[y]],t+="<br/>"),identifyLayers[identifyGroup][e.layerName].position==y){if(void 0!==identifyLayers[identifyGroup][e.layerName].one2one_fields)for(j=0;j<identifyLayers[identifyGroup][e.layerName].one2one_fields.length;j++)if(i.getElementsByTagName(identifyLayers[identifyGroup][e.layerName].one2one_fields[j]).length>0){var n=i.getElementsByTagName(identifyLayers[identifyGroup][e.layerName].one2one_fields[j])[0];n.getElementsByTagName("linkname").length>0&&n.getElementsByTagName("linkurl").length>0?(t+=identifyLayers[identifyGroup][e.layerName].one2one_display[j]+": ",t+="<a href='"+n.getElementsByTagName("linkurl")[0].firstChild.nodeValue+"'>"+n.getElementsByTagName("linkname")[0].firstChild.nodeValue+"</a>",t+="<br/>"):n.childNodes.length>0&&(t+=identifyLayers[identifyGroup][e.layerName].one2one_display[j]+": ",t+=n.childNodes[0].nodeValue,t+="<br/>")}if(void 0!==identifyLayers[identifyGroup][e.layerName].one2many_fields)for(j=0;j<identifyLayers[identifyGroup][e.layerName].one2many_fields.length;j++){var d=i.getElementsByTagName(identifyLayers[identifyGroup][e.layerName].one2many_fields[j]);t+=identifyLayers[identifyGroup][e.layerName].displaynames[0]+":<ul style='margin-top: 0px; margin-bottom: 0px;'>";for(var l=0;l<d.length;l++)d[l].getElementsByTagName("linkname").length>0&&d[l].getElementsByTagName("linkurl").length>0?t+="<li><a href='"+d[l].getElementsByTagName("linkurl")[0].firstChild.nodeValue+"' target='_blank'>"+d[l].getElementsByTagName("linkname")[0].firstChild.nodeValue+"</a></li>":t+="<li>"+d[l].childNodes[0].nodeValue+"</li>";t+="</ul style='margin-bottom: 0px; margin-top: 0px;'>"}}t+="</div><br/>",processedDatabaseCalls++,-1==a.indexOf(t)&&(a+="<div onMouseOver='javascript:highlightFeature(\""+features.length+"\")' onMouseOut='javascript:removeHighlight()'><strong>"+t,groupContent[identifyGroup]=a),features.push(e.feature)}else 404==XMLHttpRequestObjects[r].status?(alert("Identify failed. File not found: "+s,"Data Error"),processedDatabaseCalls=numDatabaseCalls,accumulateContent(a)):(alert("Identify failed for call to "+s+". Make sure it exists and does not have errors. Must be in the same directory as index.html or a lower directory. XMLHttpRequestObjects["+r+"].status was "+XMLHttpRequestObjects[r].status,"Data Error"),processedDatabaseCalls=numDatabaseCalls,accumulateContent(a));for(var o=!0,y=0;y<numDatabaseCalls;y++)if(!XMLHttpRequestObjects[y]||4!==XMLHttpRequestObjects[y].readyState){o=!1;break}o&&accumulateContent(a)}}),XMLHttpRequestObjects[index].send()}catch(t){alert("Identify on "+e.layerName+" failed with error: "+t.message+" in javascript/identify.js handleQueryResults().","Data Error"),console.log(t.message),hideLoading("")}else{t=e.layerName+"</strong><div style='padding-left: 10px;'>";var d=!0;for(-1!=e.layerName.indexOf("GMU")?theTitle[identifyGroup]="GMU "+e.feature.attributes[identifyLayers[identifyGroup][e.layerName].fields[0]]:theTitle[identifyGroup]=e.feature.attributes[identifyLayers[identifyGroup][e.layerName].fields[0]],view.popup.title=theTitle[identifyGroup],i=0;i<identifyLayers[identifyGroup][e.layerName].displaynames.length;i++)e.feature.attributes[identifyLayers[identifyGroup][e.layerName].fields[i]]&&" "!==e.feature.attributes[identifyLayers[identifyGroup][e.layerName].fields[i]]&&"Null"!==e.feature.attributes[identifyLayers[identifyGroup][e.layerName].fields[i]]&&""!==e.feature.attributes[identifyLayers[identifyGroup][e.layerName].fields[i]]&&(d?d=!1:t+="<br/>","string"==typeof e.feature.attributes[identifyLayers[identifyGroup][e.layerName].fields[i]]&&"http"==e.feature.attributes[identifyLayers[identifyGroup][e.layerName].fields[i]].substring(0,4)?t+="<a href='"+e.feature.attributes[identifyLayers[identifyGroup][e.layerName].fields[i]]+"' target='_blank'>"+identifyLayers[identifyGroup][e.layerName].displaynames[i]+"</a>":t+=identifyLayers[identifyGroup][e.layerName].displaynames[i]+": "+e.feature.attributes[identifyLayers[identifyGroup][e.layerName].fields[i]]);t+="</div></div><br/>",-1==a.indexOf(t)&&(a+="<div onMouseOver='javascript:highlightFeature(\""+features.length+"\")' onMouseOut='javascript:removeHighlight()'><strong>"+t,groupContent[identifyGroup]=a),features.push(e.feature)}})}),accumulateContent(a)}catch(e){alert(e.message+" in javascript/identify.js handleQueryResults().","Code Error",e),hideLoading("")}}function highlightFeature(e){features[e]&&features[e].geometry&&void 0!==features[e].geometry&&void 0!==features[e].geometry.type&&features[e].geometry.type&&("point"===features[e].geometry.type?addHighlightPoint(features[e],!0):"polygon"===features[e].geometry.type?addTempPolygon(features[e],!0):"polyline"===features[e].geometry.type&&addTempLine(features[e],!0))}function removeHighlight(){view.graphics.remove(view.graphics.items[view.graphics.items.length-1])}function setIdentifyFooter(e){require(["esri/request"],function(t){try{const i=setInterval(function(){let a=document.getElementById("idXY");if(a&&(clearInterval(i),projectPoint(clickPoint,a),elevation_url)){var r='{"xmin":'+view.extent.xmin+',"ymin":'+view.extent.ymin+',"xmax":'+view.extent.xmax+',"ymax":'+view.extent.ymax+',"spatialReference":{"wkid":102100,"latestWkid":102100}}',n=t(elevation_url+"/identify",{responseType:"json",query:{geometry:JSON.stringify(e),geometryType:"point",tolerance:"5",mapExtent:r,imageDisplay:view.width+","+view.height+",96",returnGeometry:!1,sr:"102100",f:"json"},responseType:"json"});n.then(function(e){var t=document.getElementById("idElevation");0==e.data.results.length||isNaN(e.data.results[0].attributes["Pixel Value"])?t.innerHTML="<strong>Elevation:</strong> data not available":t.innerHTML="<strong>Elevation:</strong> "+Math.round(e.data.results[0].attributes["Pixel Value"])+" ft, "+Math.round(.3048*e.data.results[0].attributes["Pixel Value"])+" m"},function(e){var t=getElementById("idElevation");t.innerHTML="<strong>Elevation:</strong> data not available",hideLoading("")})}},100)}catch(e){alert(e.message+" in javascript/identify.js setIdentifyFooter().","Code Error",e)}})}function changeIdentifyGroup(e){identifyGroup=e.options[e.selectedIndex].value,view.popup.content="<p align='center'>Loading...</p>",view.popupEnabled=!1,features=[],numDatabaseCalls=0,processedDatabaseCalls=0,displayContent()}function accumulateContent(e){if(numDatabaseCalls==processedDatabaseCalls){if(numDatabaseCalls=0,processedDatabaseCalls=0,0==features.length){var t,i="";identifyLayerIds[identifyGroup][0].id_vis_only&&(i="visible "),identifyLayers[identifyGroup].desc?(t="<div><p style='font-style:italic;top:-15px;position:relative;'>"+identifyLayers[identifyGroup].desc+"</p>No "+i+identifyGroup+" at this point.<br/></div>",e=t,groupContent[identifyGroup]=t,theTitle[identifyGroup]="No "+identifyGroup,view.popup.title="No "+identifyGroup,t=null):(t="<div>No "+i+identifyGroup+" at this point.<br/></div>",e=t,groupContent[identifyGroup]=t,theTitle[identifyGroup]="No "+identifyGroup,view.popup.title="No "+identifyGroup,t=null)}displayInfoWindow(e)}}function customStuff(e){const t=document.createElement("div");t.style.margin="-12px",t.style.height="100%";for(var i="<div style='padding:12px;'><strong>Show:</strong> <select id='id_group' name='id_group' style='margin:5px;color:black;' onChange='changeIdentifyGroup(this)'>",a=0;a<identifyGroups.length;a++)i+="<option",identifyGroup==identifyGroups[a]&&(i+=" selected"),i+=">"+identifyGroups[a]+"</option>";return i+="</select></div>",i+="<div style='overflow:auto;border-bottom: 1px solid #dfdfdf;padding:12px;'>"+e+"</div>",
i+="<div style='border-bottom: 1px solid #dfdfdf;padding:12px;'><calcite-icon aria-hidden='true' icon='pin-tear-f' scale='s' style='vertical-align:middle;margin-right: 5px;'></calcite-icon> <strong>Location:</strong> <input type='text' value='Loading XY...' id='idXY' disabled='true'> <a href=\"javascript:copyText('idXY')\" style='font-weight:bold;margin-left:0;padding-left:0;font-size:1.1em;text-decoration:none;font-color:var(--calcite-color-brand)'>Copy</a></div>",i+="<div style='border-bottom: 1px solid #dfdfdf;padding:12px;'><calcite-icon aria-hidden='true' icon='altitude' scale='m' style='vertical-align:middle;margin-right: 5px;'></calcite-icon> <span id='idElevation'>Loading elevation...</span></div>",i+="<div slot='footer' style='padding:12px;display:flex'><a href='javascript:zoomToPt()' style='float:left;margin-right:20px;'><calcite-icon aria-hidden='true' icon='magnifying-glass-plus' scale='s' style='vertical-align:middle;margin-right: 5px;'></calcite-icon> Zoom To</a> ",driving_directions&&(i+="<a href='javascript:getDirections()' style='float:left;'><span aria-hidden='true' class='esri-features__icon esri-icon-directions2' style='vertical-align:middle;margin-right: 5px;'></span> Get Directions</a></div>"),i+="</div>",t.innerHTML=i,t}function displayInfoWindow(e){view.popup.content=customStuff(e),view.openPopup(),setIdentifyFooter(clickPoint),hideLoading("")}function getDirections(){require(["esri/geometry/support/webMercatorUtils"],function(e){var t=e.webMercatorToGeographic(view.popup.viewModel.location),i="http://google.com/maps?output=classic&q="+t.y+","+t.x;window.open(i,"_blank")})}function zoomToPt(){var e=25e4;view.scale<25e4&&(e=view.scale),view.goTo({target:view.popup.viewModel.location,scale:e})}var tasks,clickPoint,identifyGroup,theEvt,identifyParams=null,identify=null,features=[],numDatabaseCalls=0,processedDatabaseCalls=0,folder=[],identifyGroups=[],identifyLayers={},groupContent={},theTitle=[],identifyLayerIds=[],show_elevation=!1,elevation_url=null,driving_directions=!1,tooManyRequests=!1,firstClick=!1,secondClick=!1,lastIdentifyTime=0;require(["esri/rest/support/IdentifyParameters","esri/rest/identify","esri/symbols/SimpleLineSymbol","esri/symbols/SimpleFillSymbol","esri/symbols/PictureMarkerSymbol","dojo/_base/Color"],function(e,t,i,a,r,n){identifyParams=new e,identifyParams.returnGeometry=!0,identifyParams.layerOption="all",identify=t});